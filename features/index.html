<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Features | Documentation</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/favicon.ico">
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5MC2SNS');</script>
    <meta name="description" content="To use external files with the list of Black/White IPs, place this list into the following directory:">
    <meta name="image" content="https://docs.imunify360.com/images/LowResourceUsage.png">
    <meta name="twitter:title" content="Features">
    <meta name="twitter:description" content="To use external files with the list of Black/White IPs, place this list into the following directory:">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://docs.imunify360.com/images/LowResourceUsage.png">
    <meta name="twitter:url" content="https://docs.imunify360.com/features/">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Features">
    <meta property="og:description" content="To use external files with the list of Black/White IPs, place this list into the following directory:">
    <meta property="og:image" content="https://docs.imunify360.com/images/LowResourceUsage.png">
    <meta property="og:url" content="https://docs.imunify360.com/features/">
    <meta property="og:site_name" content="Imunify 360 Documentation">
    <meta itemprop="name" content="Features">
    <meta itemprop="description" content="To use external files with the list of Black/White IPs, place this list into the following directory:">
    <meta itemprop="image" content="https://docs.imunify360.com/images/LowResourceUsage.png">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="referrer" content="unsafe-url">
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline' 'unsafe-inline' 'unsafe-eval' *.survicate.com *.googletagmanager.com *.google-analytics.com *.licdn.com *.hotjar.com *.twitter.com *.facebook.net *.kernelcare.info *.twitter.com *.ads-twitter.com;">
    <link rel="preload" href="/assets/css/0.styles.c63e9006.css" as="style"><link rel="preload" href="/assets/js/app.3abfcf7c.js" as="script"><link rel="preload" href="/assets/js/5.92c348f6.js" as="script"><link rel="preload" href="/assets/js/1.443374ed.js" as="script"><link rel="preload" href="/assets/js/22.10ceb554.js" as="script"><link rel="preload" href="/assets/js/21.53b2588b.js" as="script"><link rel="preload" href="/assets/js/2.8a6413a2.js" as="script"><link rel="prefetch" href="/assets/js/10.4eacd74a.js"><link rel="prefetch" href="/assets/js/11.7d916a01.js"><link rel="prefetch" href="/assets/js/12.ef059b28.js"><link rel="prefetch" href="/assets/js/13.4dba68c3.js"><link rel="prefetch" href="/assets/js/14.aecb78d4.js"><link rel="prefetch" href="/assets/js/15.de35870b.js"><link rel="prefetch" href="/assets/js/16.dfa2deed.js"><link rel="prefetch" href="/assets/js/17.0a7484c5.js"><link rel="prefetch" href="/assets/js/18.f5d09701.js"><link rel="prefetch" href="/assets/js/19.72baf214.js"><link rel="prefetch" href="/assets/js/20.ff3272c9.js"><link rel="prefetch" href="/assets/js/23.cd8734aa.js"><link rel="prefetch" href="/assets/js/24.46e2e4de.js"><link rel="prefetch" href="/assets/js/25.5e9168a6.js"><link rel="prefetch" href="/assets/js/26.41abb43b.js"><link rel="prefetch" href="/assets/js/27.19a9a1fc.js"><link rel="prefetch" href="/assets/js/28.39653462.js"><link rel="prefetch" href="/assets/js/29.1fbb5f5b.js"><link rel="prefetch" href="/assets/js/30.dc6a8954.js"><link rel="prefetch" href="/assets/js/31.88237e22.js"><link rel="prefetch" href="/assets/js/32.f54922c7.js"><link rel="prefetch" href="/assets/js/33.55da5043.js"><link rel="prefetch" href="/assets/js/34.dac98eb2.js"><link rel="prefetch" href="/assets/js/35.93497073.js"><link rel="prefetch" href="/assets/js/36.d4b0e799.js"><link rel="prefetch" href="/assets/js/37.5c7a76bf.js"><link rel="prefetch" href="/assets/js/38.806bd4a1.js"><link rel="prefetch" href="/assets/js/39.e42b9e34.js"><link rel="prefetch" href="/assets/js/40.bde8b4d3.js"><link rel="prefetch" href="/assets/js/41.18fa00a9.js"><link rel="prefetch" href="/assets/js/42.2c7f2862.js"><link rel="prefetch" href="/assets/js/43.48e8a33f.js"><link rel="prefetch" href="/assets/js/44.5cc2dde7.js"><link rel="prefetch" href="/assets/js/45.440e9cfa.js"><link rel="prefetch" href="/assets/js/46.b1f7b377.js"><link rel="prefetch" href="/assets/js/47.8d51c2f0.js"><link rel="prefetch" href="/assets/js/48.85d74de6.js"><link rel="prefetch" href="/assets/js/49.8859f0bb.js"><link rel="prefetch" href="/assets/js/50.b80d4c34.js"><link rel="prefetch" href="/assets/js/51.543d1120.js"><link rel="prefetch" href="/assets/js/52.0c3c3279.js"><link rel="prefetch" href="/assets/js/53.3a7deb4f.js"><link rel="prefetch" href="/assets/js/54.eaaa181f.js"><link rel="prefetch" href="/assets/js/55.25886821.js"><link rel="prefetch" href="/assets/js/56.4a0a3e24.js"><link rel="prefetch" href="/assets/js/57.8ada506b.js"><link rel="prefetch" href="/assets/js/58.21a36e8b.js"><link rel="prefetch" href="/assets/js/59.83f65949.js"><link rel="prefetch" href="/assets/js/6.2b059922.js"><link rel="prefetch" href="/assets/js/7.b0f28354.js"><link rel="prefetch" href="/assets/js/8.ae241e8f.js"><link rel="prefetch" href="/assets/js/9.7f557c27.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.12cc7b8d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c63e9006.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><!----> <header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/introduction/" class="home-link"><img src="/logo.svg" alt="Documentation" class="logo"> <span class="site-name site-name--documentation can-hide">Documentation</span></a> <form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <div class="links" style="max-width:nullpx;"><a target="_blank" class="btn">Ask GPT?</a><a href="https://www.imunify360.com/support-portal/" target="_blank" class="btn">Contact Support</a><a href="https://www.imunify360.com/trial" target="_blank" class="btn">Try Free</a> <nav class="nav-links can-hide"></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><!----> <ul class="sidebar-group-items"><li><div><a href="/introduction/" class="sidebar-link link-depth-level-0">Introduction</a></div></li><li><div><a href="/billing/" class="sidebar-link link-depth-level-0">Licensing</a></div></li><li><div class="sidebar-header sidebar-link"><div><a href="/installation/" class="sidebar-link link-depth-level-0">Installation Guide</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/installation/#requirements" class="sidebar-link link-depth-level-1">Requirements</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/installation/#installation-instructions" class="sidebar-link link-depth-level-1">Installation Instructions</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/installation/#registering" class="sidebar-link link-depth-level-2">Registering</a></div></li><li class="sidebar-sub-header"><div><a href="/installation/#selinux-support" class="sidebar-link link-depth-level-2">SELinux support</a></div></li><li class="sidebar-sub-header"><div><a href="/installation/#troubleshooting" class="sidebar-link link-depth-level-2">Troubleshooting</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div><a href="/installation/#compatibility" class="sidebar-link link-depth-level-1">Compatibility</a></div></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/update/" class="sidebar-link link-depth-level-0">Update Guide</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/update/#gradual-roll-out" class="sidebar-link link-depth-level-1">Gradual roll-out</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/update/#beta" class="sidebar-link link-depth-level-1">Beta</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/update/#production" class="sidebar-link link-depth-level-1">Production</a></div></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/command_line_interface/" class="sidebar-link link-depth-level-0">Command-line Interface (CLI)</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#_3rdparty" class="sidebar-link link-depth-level-1">3rdparty</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#backup-systems" class="sidebar-link link-depth-level-1">Backup systems</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#blacklist" class="sidebar-link link-depth-level-1">Blacklist</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#blocked-ports" class="sidebar-link link-depth-level-1">Blocked ports</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#blocked-port-ip" class="sidebar-link link-depth-level-1">Blocked Port IP</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#checkdb" class="sidebar-link link-depth-level-1">Checkdb</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#check-domains" class="sidebar-link link-depth-level-1">Check-domains</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#check-modsec-directives" class="sidebar-link link-depth-level-1">Check modsec directives</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#clean" class="sidebar-link link-depth-level-1">Clean</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#config" class="sidebar-link link-depth-level-1">Config</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#doctor" class="sidebar-link link-depth-level-1">Doctor</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#eula" class="sidebar-link link-depth-level-1">Eula</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#features" class="sidebar-link link-depth-level-1">Features</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#feature-management" class="sidebar-link link-depth-level-1">Feature-management</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#fix-modsec-directives" class="sidebar-link link-depth-level-1">Fix modsec directives</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#get" class="sidebar-link link-depth-level-1">Get</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#graylist" class="sidebar-link link-depth-level-1">Graylist</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#hooks" class="sidebar-link link-depth-level-1">Hooks</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#import" class="sidebar-link link-depth-level-1">Import</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#infected-domains" class="sidebar-link link-depth-level-1">Infected-domains</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#login" class="sidebar-link link-depth-level-1">Login</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#malware" class="sidebar-link link-depth-level-1">Malware</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#notifications-config" class="sidebar-link link-depth-level-1">Notifications config</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#proactive" class="sidebar-link link-depth-level-1">Proactive</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#register" class="sidebar-link link-depth-level-1">Register</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#reload-lists" class="sidebar-link link-depth-level-1">Reload lists</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#remote-proxy" class="sidebar-link link-depth-level-1">Remote-proxy</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#rstatus" class="sidebar-link link-depth-level-1">Rstatus</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#rules" class="sidebar-link link-depth-level-1">Rules</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#submit-false-positive-false-negative" class="sidebar-link link-depth-level-1">Submit false-positive/false-negative</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#unregister" class="sidebar-link link-depth-level-1">Unregister</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#vendors" class="sidebar-link link-depth-level-1">Vendors</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#version" class="sidebar-link link-depth-level-1">Version</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#whitelist" class="sidebar-link link-depth-level-1">Whitelist</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#whitelisted-crawlers" class="sidebar-link link-depth-level-1">Whitelisted crawlers</a></div></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/control_panel_integration/" class="sidebar-link link-depth-level-0">Control panel integration</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/control_panel_integration/#introduction" class="sidebar-link link-depth-level-1">Introduction</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/control_panel_integration/#prerequisites" class="sidebar-link link-depth-level-1">Prerequisites</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/control_panel_integration/#configure-imunify360-integrations" class="sidebar-link link-depth-level-1">Configure Imunify360 integrations</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/control_panel_integration/#install-imunify360" class="sidebar-link link-depth-level-1">Install Imunify360</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/control_panel_integration/#settings-related-to-stand-alone-version" class="sidebar-link link-depth-level-1">Settings related to Stand-alone version</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/control_panel_integration/#integration-config-file" class="sidebar-link link-depth-level-1">Integration config file</a></div></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/dashboard/" class="sidebar-link link-depth-level-0">Admin Interface</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/dashboard/#support" class="sidebar-link link-depth-level-1">Support</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#dashboard" class="sidebar-link link-depth-level-1">Dashboard</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#imunify-advisor" class="sidebar-link link-depth-level-2">Imunify Advisor</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#multi-server-dashboard" class="sidebar-link link-depth-level-2">Multi-server Dashboard</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#charts-and-heat-maps" class="sidebar-link link-depth-level-2">Charts and heat maps</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div><a href="/dashboard/#incidents" class="sidebar-link link-depth-level-1">Incidents</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#firewall" class="sidebar-link link-depth-level-1">Firewall</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#ports" class="sidebar-link link-depth-level-2">Ports</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#malware-scanner" class="sidebar-link link-depth-level-1">Malware Scanner</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#users" class="sidebar-link link-depth-level-2">Users</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#malicious" class="sidebar-link link-depth-level-2">Malicious</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#scan" class="sidebar-link link-depth-level-2">Scan</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#history" class="sidebar-link link-depth-level-2">History</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#ignore-list" class="sidebar-link link-depth-level-2">Ignore List</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#proactive-defense" class="sidebar-link link-depth-level-1">Proactive Defense</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#overview" class="sidebar-link link-depth-level-2">Overview</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#user-interface" class="sidebar-link link-depth-level-2">User Interface</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div><a href="/dashboard/#reputation-management" class="sidebar-link link-depth-level-1">Reputation Management</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/dashboard/#kernelcare-integration" class="sidebar-link link-depth-level-1">KernelCare Integration</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#settings" class="sidebar-link link-depth-level-1">Settings</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#general" class="sidebar-link link-depth-level-2">General</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#malware" class="sidebar-link link-depth-level-2">Malware</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#backups" class="sidebar-link link-depth-level-2">Backups</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#disabled-rules" class="sidebar-link link-depth-level-2">Disabled Rules</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#features-management" class="sidebar-link link-depth-level-2">Features Management</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#native-feature-management" class="sidebar-link link-depth-level-2">Native Feature Management</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#whm-cpanel" class="sidebar-link link-depth-level-2">WHM/cPanel</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#attributions" class="sidebar-link link-depth-level-2">Attributions</a></div></li></ul></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/user_interface/" class="sidebar-link link-depth-level-0">User Interface</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/user_interface/#files" class="sidebar-link link-depth-level-1">Files</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/user_interface/#history" class="sidebar-link link-depth-level-1">History</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/user_interface/#ignore-list" class="sidebar-link link-depth-level-1">Ignore List</a></div></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/ids_integration/" class="sidebar-link link-depth-level-0">Other Integrations</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/ids_integration/#ids-integration" class="sidebar-link link-depth-level-1">IDS Integration</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/ids_integration/#csf-integration" class="sidebar-link link-depth-level-2">CSF Integration</a></div></li><li class="sidebar-sub-header"><div><a href="/ids_integration/#cxs-integration" class="sidebar-link link-depth-level-2">CXS Integration</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/ids_integration/#backup-providers-integration" class="sidebar-link link-depth-level-1">Backup Providers Integration</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/ids_integration/#overview" class="sidebar-link link-depth-level-2">Overview</a></div></li><li class="sidebar-sub-header"><div><a href="/ids_integration/#command-line-usage" class="sidebar-link link-depth-level-2">Command Line Usage</a></div></li><li class="sidebar-sub-header"><div><a href="/ids_integration/#using-as-library" class="sidebar-link link-depth-level-2">Using as Library</a></div></li><li class="sidebar-sub-header"><div><a href="/ids_integration/#creating-custom-backup-backend-plugin" class="sidebar-link link-depth-level-2">Creating Custom Backup Backend Plugin</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/ids_integration/#hosting-panels-firewall-rulesets-specific-settings-modsecurity" class="sidebar-link link-depth-level-1">Hosting Panels Firewall Rulesets Specific Settings &amp; ModSecurity</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/ids_integration/#cpanel" class="sidebar-link link-depth-level-2">cPanel</a></div></li><li class="sidebar-sub-header"><div><a href="/ids_integration/#plesk" class="sidebar-link link-depth-level-2">Plesk</a></div></li><li class="sidebar-sub-header"><div><a href="/ids_integration/#directadmin" class="sidebar-link link-depth-level-2">DirectAdmin</a></div></li></ul></li></ul></li><li><div class="active collapsed sidebar-header sidebar-link"><div class="active"><a href="/features/" class="active sidebar-link link-depth-level-0">Features</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/features/#external-black-whitelist-management" class="sidebar-link link-depth-level-1">External Black/Whitelist Management</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/features/#rapidscan" class="sidebar-link link-depth-level-1">RapidScan</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/features/#low-resource-usage-mode" class="sidebar-link link-depth-level-1">Low Resource Usage mode</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/features/#exim-dovecot-brute-force-attack-protection" class="sidebar-link link-depth-level-1">Exim+Dovecot brute-force attack protection</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/features/#dovecot-native-brute-force-protection" class="sidebar-link link-depth-level-2">Dovecot native brute force protection</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div><a href="/features/#notifications" class="sidebar-link link-depth-level-1">Notifications</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/features/#malware-database-scanner-mds" class="sidebar-link link-depth-level-1">Malware Database Scanner (MDS)</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/features/#how-to-use-malware-database-scanner-mds" class="sidebar-link link-depth-level-2">How to use Malware Database Scanner (MDS)</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/features/#webshield" class="sidebar-link link-depth-level-1">Webshield</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/features/#captcha" class="sidebar-link link-depth-level-2">Captcha</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#configuring-recaptcha-keys" class="sidebar-link link-depth-level-2">Configuring reCAPTCHA keys</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#cdn-support" class="sidebar-link link-depth-level-2">CDN Support</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#using-cloudflare-cache-everything-with-imunify360" class="sidebar-link link-depth-level-2">Using Cloudflare “Cache Everything” with Imunify360</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#anti-bot-protection" class="sidebar-link link-depth-level-2">Anti-bot protection</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div><a href="/features/#overridable-config" class="sidebar-link link-depth-level-1">Overridable config</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/features/#scan-of-the-system-and-user-crontab-files-for-malicious-jobs" class="sidebar-link link-depth-level-1">Scan of the system and user crontab files for malicious jobs</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/features/#hooks" class="sidebar-link link-depth-level-1">Hooks</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/features/#overview" class="sidebar-link link-depth-level-2">Overview</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#how-to-start-using-hooks" class="sidebar-link link-depth-level-2">How to start using hooks</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#available-events-and-their-parameters" class="sidebar-link link-depth-level-2">Available events and their parameters</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#cli" class="sidebar-link link-depth-level-2">CLI</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#native" class="sidebar-link link-depth-level-2">Native</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#log-file" class="sidebar-link link-depth-level-2">Log File</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#structure-and-examples-of-a-hook-script" class="sidebar-link link-depth-level-2">Structure and examples of a hook script</a></div></li></ul></li></ul></li><li><div><a href="/whmcs_plugin/" class="sidebar-link link-depth-level-0">WHMCS Plugin</a></div></li><li><div><a href="/terminology/" class="sidebar-link link-depth-level-0">Terminology</a></div></li><li><div><a href="/localization/" class="sidebar-link link-depth-level-0">Localization</a></div></li><li><div><a href="/config_file_description/" class="sidebar-link link-depth-level-0">Config File Description</a></div></li><li><div class="sidebar-header sidebar-link"><div><a href="/faq_and_known_issues/" class="sidebar-link link-depth-level-0">FAQ and Known Issues</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/faq_and_known_issues/#common-questions" class="sidebar-link link-depth-level-1">Common Questions</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_1-end-user-ip-is-blocked-and-i-do-not-know-why" class="sidebar-link link-depth-level-2">1. End user IP is blocked and I do not know why</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_2-could-i-disable-iptables-firewall-or-ossec-when-using-imunify360" class="sidebar-link link-depth-level-2">2. Could I disable IPtables (firewall) or OSSEC, when using Imunify360?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_3-does-imunify360-log-events-such-as-adding-or-removing-an-ip-to-from-the-gray-list" class="sidebar-link link-depth-level-2">3. Does Imunify360 log events such as adding or removing an IP to/from the Gray List?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_5-to-start-using-imunify360-we-need-to-know-which-information-is-sent-to-your-servers-could-you-please-give-us-some-more-information" class="sidebar-link link-depth-level-2">5. To start using Imunify360 we need to know which information is sent to your servers. Could you please give us some more information?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_6-no-valid-imunify360-license-found" class="sidebar-link link-depth-level-2">6. No valid Imunify360 License Found.</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_7-i-have-an-error-peewee-databaseerror-database-disk-image-is-malformed-what-should-i-do" class="sidebar-link link-depth-level-2">7. I have an error peewee.DatabaseError: database disk image is malformed. What should I do?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_8-why-does-my-cpanel-with-litespeed-and-owasp-modsecurity-rule-set-trigger-500-error-on-all-web-pages-after-installing-imunify360" class="sidebar-link link-depth-level-2">8. Why does my cPanel with LiteSpeed and OWASP ModSecurity rule set trigger 500 error on all web pages after installing Imunify360?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_9-disabling-waf-rules-for-certain-countries" class="sidebar-link link-depth-level-2">9. Disabling WAF rules for certain countries.</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_10-how-to-clone-imunify360-configuration-on-another-system" class="sidebar-link link-depth-level-2">10. How to clone Imunify360 configuration on another system?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_11-how-to-disable-support-icon-in-the-imunify360-ui" class="sidebar-link link-depth-level-2">11. How to disable Support icon in the Imunify360 UI?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_12-how-to-hide-the-ignore-list-tab-for-end-users-in-the-imunify360-ui" class="sidebar-link link-depth-level-2">12. How to hide the Ignore List tab for end users in the Imunify360 UI?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_13-how-to-delete-malware-scan-results-from-imunify360-s-database" class="sidebar-link link-depth-level-2">13. How to delete malware scan results from Imunify360’s database?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_14-imunify360-webshield-could-not-allocate-memory-problem-how-to-fix" class="sidebar-link link-depth-level-2">14. Imunify360 WebShield ‘Could not allocate memory’ problem. How to fix?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_15-how-to-check-modsecurity-scan-works" class="sidebar-link link-depth-level-2">15. How to check &quot;ModSecurity scan&quot; works?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_16-how-to-check-automatically-scan-all-modified-files-works" class="sidebar-link link-depth-level-2">16. How to check &quot;automatically scan all modified files&quot; works?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_17-malware-file-reasons" class="sidebar-link link-depth-level-2">17. Malware file reasons</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_18-can-imunify360-firewall-block-traffic-by-domain-name" class="sidebar-link link-depth-level-2">18. Can Imunify360 firewall block traffic by domain name?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_19-what-ports-are-used-by-webshield" class="sidebar-link link-depth-level-2">19. What ports are used by WebShield?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_20-how-to-check-that-captcha-works" class="sidebar-link link-depth-level-2">20. How to check that CAPTCHA works?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_21-how-to-edit-watched-and-excluded-patterns-for-malware-scanner" class="sidebar-link link-depth-level-2">21. How to edit watched and excluded patterns for Malware Scanner?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_22-how-to-test-rules-based-on-modsecurity-tags" class="sidebar-link link-depth-level-2">22. How to test rules based on ModSecurity tags?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_23-imunify-agent-is-not-running-troubleshooting" class="sidebar-link link-depth-level-2">23. &quot;Imunify agent is not running&quot; troubleshooting</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_24-ssh-exchange-identification-connection-closed-by-remote-host-troubleshooting" class="sidebar-link link-depth-level-2">24. &quot;sshexchangeidentification: Connection closed by remote host&quot; troubleshooting</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_25-where-can-i-find-the-files-backup-location" class="sidebar-link link-depth-level-2">25. Where can I find the files backup location?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_26-ipset-max-elements-error-hash-is-full-cannot-add-more-elements" class="sidebar-link link-depth-level-2">26. Ipset max elements error &quot;Hash is full, cannot add more elements&quot;</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_27-how-to-enable-scan-for-end-users" class="sidebar-link link-depth-level-2">27. How to enable scan for end-users?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_28-how-can-i-disable-rbl-based-waf-protection" class="sidebar-link link-depth-level-2">28. How can I disable RBL-based WAF protection?</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/faq_and_known_issues/#corner-cases" class="sidebar-link link-depth-level-1">Corner cases</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#ip-whitelisting-port-blocking-precedence" class="sidebar-link link-depth-level-2">IP whitelisting/port blocking precedence</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/faq_and_known_issues/#plesk-related" class="sidebar-link link-depth-level-1">Plesk related</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#how-to-get-an-imunify-activation-key-from-the-extended-plesk-license" class="sidebar-link link-depth-level-2">How to get an Imunify activation key from the extended Plesk license</a></div></li></ul></li></ul></li><li><div><a href="/uninstall/" class="sidebar-link link-depth-level-0">Uninstall</a></div></li></ul></div></li></ul> </div> <div class="page"> <div class="breadcrumb-wrapper page-breadcrumb" data-v-5e0e0acf><span class="breadcrumb-title" data-v-5e0e0acf>Documentation:</span> <a href="/features/" class="breadcrumb router-link-exact-active router-link-active" data-v-5e0e0acf>
    Features
  </a></div> <div class="page-nav-wrapper"><div class="page-nav"><a href="/ids_integration/" class="nav-arrow left"></a> <a href="/whmcs_plugin/" class="nav-arrow right"></a></div></div> <div class="content content__default"><h1 id="features"><a href="#features" aria-hidden="true" class="header-anchor">#</a> Features</h1> <p></p><div class="table-of-contents"><ul><li><a href="#external-black-whitelist-management">External Black/Whitelist Management</a></li><li><a href="#rapidscan">RapidScan</a></li><li><a href="#low-resource-usage-mode">Low Resource Usage mode</a></li><li><a href="#exim-dovecot-brute-force-attack-protection">Exim+Dovecot brute-force attack protection</a><ul><li><a href="#dovecot-native-brute-force-protection">Dovecot native brute force protection</a></li></ul></li><li><a href="#notifications">Notifications</a></li><li><a href="#malware-database-scanner-mds">Malware Database Scanner (MDS)</a><ul><li><a href="#how-to-use-malware-database-scanner-mds">How to use Malware Database Scanner (MDS)</a></li></ul></li><li><a href="#webshield">Webshield</a><ul><li><a href="#captcha">Captcha</a></li><li><a href="#configuring-recaptcha-keys">Configuring reCAPTCHA keys</a></li><li><a href="#cdn-support">CDN Support</a></li><li><a href="#using-cloudflare-cache-everything-with-imunify360">Using Cloudflare “Cache Everything” with Imunify360</a></li><li><a href="#anti-bot-protection">Anti-bot protection</a></li></ul></li><li><a href="#overridable-config">Overridable config</a></li><li><a href="#scan-of-the-system-and-user-crontab-files-for-malicious-jobs-badge-text-experimental-type-note">Scan of the system and user crontab files for malicious jobs <span class="badge note" style="vertical-align:top;" data-v-17014d78>Experimental</span></a></li><li><a href="#hooks-badge-text-deprecated-type-warning">Hooks <span class="badge warning" style="vertical-align:top;" data-v-17014d78>Deprecated</span></a><ul><li><a href="#overview">Overview</a></li><li><a href="#how-to-start-using-hooks">How to start using hooks</a></li><li><a href="#available-events-and-their-parameters">Available events and their parameters</a></li><li><a href="#cli">CLI</a></li><li><a href="#native">Native</a></li><li><a href="#log-file">Log File</a></li><li><a href="#structure-and-examples-of-a-hook-script">Structure and examples of a hook script</a></li></ul></li></ul></div><p></p> <h2 id="external-black-whitelist-management"><a href="#external-black-whitelist-management" aria-hidden="true" class="header-anchor">#</a> External Black/Whitelist Management</h2> <p>To use external files with the list of <span class="notranslate">Black/White IPs</span>, place this list into the following directory:</p> <ul><li>for the White List:</li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>/etc/imunify360/whitelist/*.txt
</code></pre></div></div> <ul><li>for the Black List:</li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>/etc/imunify360/blacklist/*.txt
</code></pre></div></div> <p>The files may have IP addresses or subnet in <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing" target="_blank" rel="noopener noreferrer">CIDR notation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>In order to apply the IP lists, run the following command:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent reload-lists
</code></pre></div></div> <p>Or restart the agent.</p> <div class="warning custom-block"><p class="custom-block-title">Warning</p><p>Specifying IPs in those files will not prevent Imunify from adding the same IPs to dynamic lists (like Gray list), but all White lists always have the priority over Black lists when it comes to actual filtering of requests/packages.</p></div><h2 id="rapidscan"><a href="#rapidscan" aria-hidden="true" class="header-anchor">#</a> RapidScan</h2> <p>The RapidScan feature increases scanning speed by lowering system resource usage. Increased scanning speeds and a higher scanning rate further hardens system security posture.</p> <h4 id="rapidscan-techniques"><a href="#rapidscan-techniques" aria-hidden="true" class="header-anchor">#</a> RapidScan techniques</h4> <ul><li><strong>Faster File Integrity Checking</strong>. File metadata - file hashes are stored locally. This means that if the file didn't change since the last scan it won't need to be re-scanned.</li> <li><strong>Efficient Cloud-assisted Scanning</strong>. Imunify360 stores its malicious file hash database in the cloud. Cloud assistance helps to detect malicious files and skip well known files that were white-listed. This means that only unfamiliar files remain to be scanned locally, resulting in significantly reduced scan times.</li> <li><strong>Optimized Malware Signatures</strong>. Our malware signature database continually grows to reflect the ever-expanding variety of malicious software. As the database becomes more accurate and comprehensive, it also becomes larger and more cumbersome to index. We tackle this by actively curating the database and re-evaluating complex signatures, recasting any of them that could be improved in order to make a positive effect on scanning performance.</li></ul> <h4 id="what-does-it-mean-for-you"><a href="#what-does-it-mean-for-you" aria-hidden="true" class="header-anchor">#</a> What does it mean for you?</h4> <p>After enabling  the RapidScan feature, the next scan runs with the usual speed. However, the subsequent scans speeds will improve, and they will run anywhere between 5 to 20 times faster. This is the case for both on-demand and scheduled scans, and it means, among other things, you can can increase scan frequency without affecting system performance.</p> <p>To take advantage of this feature, go to your Imunify360 control panel and enable RapidScan in Settings→Malware Scanner. Please see the details
<a href="/dashboard/#malware">here</a>.</p> <h2 id="low-resource-usage-mode"><a href="#low-resource-usage-mode" aria-hidden="true" class="header-anchor">#</a> Low Resource Usage mode</h2> <p>This is a special operation mode where Imunify360 consumes less CPU and RAM. It is intended for servers with limited resources.</p> <p>This mode disables <span class="notranslate"><a href="/webshield/">WebShield</a></span> switching off GrayList and Captcha.</p> <p><span class="notranslate"><em>Low Resource Usage</em></span> mode also enables the <span class="notranslate"><em><a href="/dashboard/#waf-settings">Minimized Modsec Ruleset</a></em></span> option that disables Imunify WAF rules with a high memory footprint, leaving critical rulesets enabled.</p> <p>When the <span class="notranslate"><em>Low Resource Usage</em></span> mode is activated it is reflected on the UI: an Imunify main menu changes color to light green, and an appropriate label appears on the top right.</p> <p><img src="/images/LowResourceUsage.png" alt=""></p> <h4 id="how-to-switch-from-the-low-resource-usage-mode-to-the-normal-resource-usage-mode"><a href="#how-to-switch-from-the-low-resource-usage-mode-to-the-normal-resource-usage-mode" aria-hidden="true" class="header-anchor">#</a> How to switch from the Low Resource Usage mode to the normal resource usage mode</h4> <p>You can switch the mode via CLI and in the UI.</p> <p>In CLI, run the following commands:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent config update '{&quot;WEBSHIELD&quot;: {&quot;enable&quot;: true}}'
imunify360-agent config update '{&quot;MOD_SEC&quot;: {&quot;ruleset&quot;: &quot;FULL&quot;}}'
</code></pre></div></div> <p>In the UI, do the following steps:</p> <ol><li>Go to <span class="notranslate"><em>Settings</em> | <em>General</em> | <em>WebShield</em></span> and enable <em>WebShield</em>:</li></ol> <p><img src="/images/WebShieldEnabled.jpeg" alt=""></p> <ol start="2"><li>Go to <span class="notranslate"><em>Settings</em> | <em>General</em> | <em>WAF Settings</em></span> and disable <em>Minimized ModSec Ruleset</em>:</li></ol> <p><img src="/images/MinimazedModSecRulesetDisable.jpeg" alt=""></p> <h2 id="exim-dovecot-brute-force-attack-protection"><a href="#exim-dovecot-brute-force-attack-protection" aria-hidden="true" class="header-anchor">#</a> Exim+Dovecot brute-force attack protection</h2> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>cPanel only, other panels will be added later</p></div><p>Exim+Dovecot brute-force attack protection is an advanced protection against Dovecot brute-force attacks. PAM module protects against IMAP/POP3 brute-force attack and prevents mail account from being compromised via brute-forcing.</p> <p><strong>How to enable Dovecot</strong></p> <p>We recommend using Imunify360 agent config to enable Dovecot because this allows to correctly switch OSSEC rules/configs:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent config update '{&quot;PAM&quot;: {&quot;enable&quot;: true, &quot;exim_dovecot_protection&quot;: true}}'
</code></pre></div></div> <p><strong>How to disable Dovecot</strong></p> <p>To disable all PAM module via config file:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent config update '{&quot;PAM&quot;: {&quot;enable&quot;: false, &quot;exim_dovecot_protection&quot;: false}}'
</code></pre></div></div> <p>To disable only Exim+Dovecot via config file:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent config update '{&quot;PAM&quot;: {&quot;exim_dovecot_protection&quot;: false}}'
</code></pre></div></div> <p>The options of the <code>pam_imunufy</code> are placed in the file: <span class="notranslate"><code>/etc/pam_imunify/i360.ini</code></span></p> <p><strong>Values</strong></p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>USER_LOCK_TIMEOUT=5</code></span></td> <td>a period of time during which a user should be blocked (minutes)</td></tr> <tr><td><span class="notranslate"><code>USER_LOCK_ATTEMPTS=10</code></span></td> <td>a number of attempts after which a user should be blocked</td></tr> <tr><td><span class="notranslate"><code>USER_LOCK_MINUTES=5</code></span></td> <td>a period of time (minutes) during which violation attempts from a user are counted; all attempts earlier than <span class="notranslate"><code>USER_LOCK_MINUTES</code></span> are not counted</td></tr> <tr><td><span class="notranslate"><code>USER_IP_LOCK_TIMEOUT=5</code></span></td> <td>a period of time during which a user + IP should be blocked (minutes)</td></tr> <tr><td><span class="notranslate"><code>USER_IP_LOCK_ATTEMPTS=10</code></span></td> <td>a number of attempts after which a user + IP should be blocked</td></tr> <tr><td><span class="notranslate"><code>USER_IP_LOCK_MINUTES=5</code></span></td> <td>a period of time (minutes) during which violation attempts from a user + IP are counted; all attempts earlier than <span class="notranslate"><code>USER_IP_LOCK_MINUTES</code></span> are not counted</td></tr> <tr><td><span class="notranslate"><code>IP_LOCK_TIMEOUT=5</code></span></td> <td>a period of time during which an IP should be blocked (minutes)</td></tr> <tr><td><span class="notranslate"><code>IP_LOCK_ATTEMPTS=10</code></span></td> <td>a number of attempts after which an IP should be blocked</td></tr> <tr><td><span class="notranslate"><code>IP_LOCK_MINUTES=5</code></span></td> <td>a period of time during which violation attempts from an IP are counted; all attempts earlier than <span class="notranslate"><code>IP_LOCK_MINUTES</code></span> are not counted</td></tr> <tr><td><span class="notranslate"><code>rbl=net-brute.rbl.imunify.com.</code></span></td> <td>RBL DNS Zone</td></tr> <tr><td><span class="notranslate"><code>RBL_timeout=5</code></span></td> <td>this is the wait time for a response from RBL</td></tr> <tr><td><span class="notranslate"><code>RBL_nameserver=ns1-rbl.imunify.com:53</code></span></td> <td>NS Server</td></tr></tbody></table> <div class="tip custom-block"><p class="custom-block-title">Notes</p><p>Default RBL block time for IP = 4 hours.</p></div><p><strong>How to apply settings</strong></p> <p>In order to apply new settings in the <span class="notranslate"><code>/etc/pam_imunify/i360.ini</code></span>, run the following command:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>systemctl restart imunify360-pam
</code></pre></div></div> <h4 id="how-it-works"><a href="#how-it-works" aria-hidden="true" class="header-anchor">#</a> How it works</h4> <p>During the last <span class="notranslate"><code>XXX_LOCK_MINUTES</code></span> we count the number of login failures (unsuccessful login attempts). If the number of attempts exceeds the specified threshold <span class="notranslate"><code>XXX_LOCK_ATTEMPTS</code></span>, the PAM plugin blocks access for <span class="notranslate"><code>XXX_LOCK_TIMEOUT</code></span> minutes. After that, the counter is reset and the process repeats.
Note that the plugin has three separate counters and a set of settings for USER/IP/USER+IP management regarding brute-force attacks (see the table above).</p> <div class="tip custom-block"><p class="custom-block-title">Notes</p><ul><li>If a user is blocked by <span class="notranslate"><code>USER_LOCK_ATTEMPTS</code></span>, then this user will not have access to the server from any IP</li> <li>If a user is blocked by <span class="notranslate"><code>USER_IP_LOCK_ATTEMPTS</code></span>, then this user will not have access to the server from that specific IP</li> <li>If an IP is blocked by <span class="notranslate"><code>IP_LOCK_ATTEMPTS</code></span>, then all users will not have access to the server from that specific blocked IP</li></ul></div><h3 id="dovecot-native-brute-force-protection"><a href="#dovecot-native-brute-force-protection" aria-hidden="true" class="header-anchor">#</a> Dovecot native brute force protection</h3> <p>Dovecot native brute force protection module improves stability and resolves issues that standard PAM caused in some cases</p> <p>There were situations when login with enabled PAM would produce log messages like these:</p> <div class="language- extra-class"><pre class="language-text"><code>Jun 9 14:45:04 Hostl6 dovecot: auth-worker(31382): Error: pam(user@example.org,&lt;IP&gt;,&lt;SESSION&gt;): Multiple password values not supported
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>Jun 9 14:45:10 Hostl6 dovecot: pop3-login: Disconnected (auth failed, 1 attempts in 6 secs): user=&lt;user@example.org&gt;, method=PLAIN, rip=&lt;IP&gt;, lip=&lt;IP&gt;, TLS, session=&lt;SESSION&gt;
</code></pre></div><p>This happened due to the specificity of PAM’s architecture and the way it processes such cases. We decided to develop a completely new native module for Dovecot with brute force protection functionality. With the new module, Dovecot will not produce any more error messages similar to shown above.</p> <p>Since the module is fresh, it is in experimental mode – disabled by default for now. This will be changed to “enabled by default” state in later releases.</p> <p>Now two options can be used to control how brute force protection works for Dovecot:</p> <table><tr><th colspan="2">Condition</th> <th rowspan="2">Behavior</th></tr> <tr><td>PAM.exim_dovecot_protection</td> <td>PAM.exim_dovecot_native</td></tr> <tr><td><center>false</center></td> <td><center>any</center></td> <td>Dovecot protection <b>disabled</b></td></tr> <tr><td><center>true</center></td> <td><center>false</center></td> <td>Dovecot protection <b>enabled</b> (default)
      <ul><li>PAM-based module</li></ul></td></tr> <tr><td><center>true</center></td> <td><center>true</center></td> <td>Dovecot protection <b>enabled</b> <ul><li>Native module ON</li></ul></td></tr></table> <p>The following commands can be used to control the Dovecot native module:</p> <p>Enable:</p> <div class="language- extra-class"><pre class="language-text"><code># imunify360-agent config update '{&quot;PAM&quot;: {&quot;exim_dovecot_native&quot;: true}}'
</code></pre></div><p>Disable (default):</p> <div class="language- extra-class"><pre class="language-text"><code># imunify360-agent config update '{&quot;PAM&quot;: {&quot;exim_dovecot_native&quot;: false}}'
</code></pre></div><h2 id="notifications"><a href="#notifications" aria-hidden="true" class="header-anchor">#</a> Notifications</h2> <p>Starting from version 4.10, an administrator is able to configure email addresses to submit reports and execute custom scripts. Go to <span class="notranslate"><em>Settings</em></span> and choose <span class="notranslate"><em>Notifications</em></span> tab.</p> <p><img src="/images/notifications.png" alt=""></p> <ul><li><span class="notranslate"><strong>Default admin emails</strong></span>: specify the default list of emails used for all enabled admin email notifications.</li> <li><span class="notranslate"><strong>From</strong></span>: specify a sender of all emails sent by the Hooks.</li></ul> <p>The following events are available.</p> <h4 id="real-time-scan-malware-detected"><a href="#real-time-scan-malware-detected" aria-hidden="true" class="header-anchor">#</a> Real-Time scan: malware detected</h4> <p>Occurs when malware is detected during the real-time scanning.</p> <p><img src="/images/RealTimeScanDetected.png" alt=""></p> <ul><li><span class="notranslate"><strong>Enable email notifications for admin</strong></span>: move the slider to <span class="notranslate">ON</span> to notify the administrator and a custom user list via email upon event occurrence. To notify the administrator on the default admin email, tick the <span class="notranslate"><em>Default admin emails</em></span> checkbox.</li> <li><span class="notranslate"><strong>Notify every (mins)</strong></span>: set a notification interval in minutes. The data for all events that happened within the interval will be accumulated and sent altogether.</li> <li><span class="notranslate"><strong>Admin emails</strong></span>: tick the <span class="notranslate"><em>Default admin emails</em></span> and/or specify your emails for notifications.</li> <li><span class="notranslate"><strong>Enable script execution</strong></span>: move the slide to <span class="notranslate">ON</span> to run a script (event handler) upon event occurrence.</li> <li><span class="notranslate"><strong>Notify every (sec)</strong></span>: set a notification interval in seconds. The data for all events that happened within the interval will be accumulated and sent altogether.</li> <li><span class="notranslate"><strong>Run a script</strong></span>: specify the full path to the script(s) or any other Linux executable to be launched on event occurrence. Make sure that the script has an executable bit (+x) on. A line-separated list of scripts is supported.</li></ul> <h4 id="user-scan-started"><a href="#user-scan-started" aria-hidden="true" class="header-anchor">#</a> User scan: started</h4> <p>Occurs immediately after the user scanning has started.</p> <p><img src="/images/UserScanStarted.png" alt=""></p> <h4 id="custom-scan-started"><a href="#custom-scan-started" aria-hidden="true" class="header-anchor">#</a> Custom scan: started</h4> <p><img src="/images/CustomScanStarted.png" alt=""></p> <p>Occurs immediately after on-demand (manual) scanning has started.</p> <h4 id="user-scan-finished"><a href="#user-scan-finished" aria-hidden="true" class="header-anchor">#</a> User scan: finished</h4> <p>Occurs immediately after the user scanning has finished, regardless the malware has found or not.</p> <p><img src="/images/UserScanFinished.png" alt=""></p> <h4 id="custom-scan-finished"><a href="#custom-scan-finished" aria-hidden="true" class="header-anchor">#</a> Custom scan: finished</h4> <p><img src="/images/CustomScanFinished.png" alt=""></p> <p>Occurs immediately after on-demand (manual) scanning has finished, regardless the malware has found or not.</p> <h4 id="custom-scan-malware-detected"><a href="#custom-scan-malware-detected" aria-hidden="true" class="header-anchor">#</a> Custom scan: malware detected</h4> <p>Occurs when the on-demand scanning process has finished and malware found.</p> <p><img src="/images/CustomScanDetected.png" alt=""></p> <h4 id="user-scan-malware-detected"><a href="#user-scan-malware-detected" aria-hidden="true" class="header-anchor">#</a> User scan: malware detected</h4> <p>Occurs when the malware scanning process of a user account has finished and malware found.</p> <p><img src="/images/UserScanDetected.png" alt=""></p> <h4 id="script-blocked"><a href="#script-blocked" aria-hidden="true" class="header-anchor">#</a> Script blocked</h4> <p>Occurs when the Proactive Defense has blocked malicious script.</p> <p><img src="/images/ScriptBlocked.png" alt=""></p> <p>Click <span class="notranslate"><em>Save changes</em></span> at the bottom to apply all changes.</p> <h2 id="malware-database-scanner-mds"><a href="#malware-database-scanner-mds" aria-hidden="true" class="header-anchor">#</a> Malware Database Scanner (MDS)</h2> <p><span class="notranslate">Malware Database Scanner (MDS)</span> is designed to solve all malware related problems in the database.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>Version Imunify360 6.0 or later supports the use of MDS in UI.</p></div><div class="danger custom-block"><p class="custom-block-title">Warning</p><p>For now, Malware Database Scanner (MDS) supports WordPress databases only.</p></div><h3 id="how-to-use-malware-database-scanner-mds"><a href="#how-to-use-malware-database-scanner-mds" aria-hidden="true" class="header-anchor">#</a> How to use Malware Database Scanner (MDS)</h3> <p>To provide safe work with database MDS supports several methods:</p> <ul><li><span class="notranslate"><code>--scan</code></span> - only scan the database, no changes will be applied</li> <li><span class="notranslate"><code>--clean</code></span> - scan database and clean-up malicious</li> <li><span class="notranslate"><code>--restore</code></span> - restore data affected by clean-up from the backup CSV file</li></ul> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>“Clean” operation includes “scan”, so you don’t need to run a scan before the cleanup. Whereas the “scan” can be used for non-disruptive checks of the database. Cleanup mode creates a backup file that can be used to rollback all changes back. It makes MDS safe to use and prevents websites from breaking and data loss.</p></div><p>The easiest way to use MDS is to run it with  <span class="notranslate"><code>--search-configs</code></span> argument: MDS will try to find the config files and print out database credentials that should be later specified for scanning.</p> <p><span class="notranslate"><code>--creds-from-xargs</code></span> argument can be used to run MDS without a need to manually enter credentials. It allows automating the process of credentials discovery and the scan process.</p> <h4 id="usage"><a href="#usage" aria-hidden="true" class="header-anchor">#</a> Usage</h4> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>/opt/ai-bolit/wrapper /opt/ai-bolit/imunify_dbscan.php [OPTIONS] [PATH]
</code></pre></div></div> <p><strong>Options</strong></p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>--host=&lt;host&gt;</code></span></td> <td>Database host</td></tr> <tr><td><span class="notranslate"><code>--port=&lt;port&gt;</code></span></td> <td>Database port</td></tr> <tr><td><span class="notranslate"><code>--login=&lt;username&gt;</code></span></td> <td>Database username</td></tr> <tr><td><span class="notranslate"><code>--password=&lt;password&gt;</code></span></td> <td>Database password</td></tr> <tr><td><span class="notranslate"><code>--password-from-stdin</code></span></td> <td>Get database password from stdin</td></tr> <tr><td><span class="notranslate"><code>--database=&lt;db_name&gt;</code></span></td> <td>Database name</td></tr> <tr><td><span class="notranslate"><code>--prefix=&lt;prefix&gt;</code></span></td> <td>Prefix for table</td></tr> <tr><td><span class="notranslate"><code>--scan</code></span></td> <td>Do scan</td></tr> <tr><td><span class="notranslate"><code>--clean</code></span></td> <td>Do clean</td></tr> <tr><td><span class="notranslate"><code>--search-configs</code></span></td> <td>Find the config files and print out database credentials</td></tr> <tr><td><span class="notranslate"><code>--creds-from-xargs</code></span></td> <td>Discover credentials and do scan</td></tr> <tr><td><span class="notranslate"><code>--report-file=&lt;filepath&gt;</code></span></td> <td>Filepath where to put the report</td></tr> <tr><td><span class="notranslate"><code>--signature-db=&lt;filepath&gt;</code></span></td> <td>Filepath with signatures</td></tr> <tr><td><span class="notranslate"><code>--progress=&lt;filepath&gt;</code></span></td> <td>Filepath with progress</td></tr> <tr><td><span class="notranslate"><code>--shared-mem-progress=&lt;shmem_id&gt;</code></span></td> <td>ID of shared memory segment</td></tr> <tr><td><span class="notranslate"><code>--create-shared-mem</code></span></td> <td>MDS create own shared memory segment</td></tr> <tr><td><span class="notranslate"><code>--status=&lt;filepath&gt;</code></span></td> <td>Filepath with status for control task</td></tr> <tr><td><span class="notranslate"><code>--avdb=&lt;filepath&gt;</code></span></td> <td>Filepath with ai-bolit signatures database</td></tr> <tr><td><span class="notranslate"><code>--procudb=&lt;filepath&gt;</code></span></td> <td>Filepath with procu signatures database</td></tr> <tr><td><span class="notranslate"><code>--state-file=&lt;filepath&gt;</code></span></td> <td>Filepath with info about state (content: <span class="notranslate"><code>new</code>/<code>working</code>/<code>done</code>/<code>canceled</code></span>). You can change it on <span class="notranslate"><code>canceled</code></span>.</td></tr> <tr><td><span class="notranslate"><code>--restore=&lt;filepath&gt;</code></span></td> <td>Filepath to restore CSV file</td></tr> <tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>Display this help and exit</td></tr> <tr><td><span class="notranslate"><code>-v, --version</code></span></td> <td>Show version</td></tr></tbody></table> <h4 id="example-of-usage"><a href="#example-of-usage" aria-hidden="true" class="header-anchor">#</a> Example of usage</h4> <h4 id="scan-database"><a href="#scan-database" aria-hidden="true" class="header-anchor">#</a> Scan database</h4> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># /opt/ai-bolit/wrapper /opt/ai-bolit/imunify_dbscan.php --port=3306 --login=user --password-from-stdin --database=$DATABASE --avdb=/var/imunify360/files/sigs/v1/aibolit/mds-ai-bolit-hoster.db --report-file=`pwd`/report.json --scan
</code></pre></div></div> <p>Scan results will be stored in the <span class="notranslate"><code>report.json</code></span>.</p> <h4 id="scan-clean-up-database"><a href="#scan-clean-up-database" aria-hidden="true" class="header-anchor">#</a> Scan &amp; Clean-up database</h4> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>#  /opt/ai-bolit/wrapper /opt/ai-bolit/imunify_dbscan.php --port=3306 --login=user --password-from-stdin --database=$DATABASE --avdb=/var/imunify360/files/sigs/v1/aibolit/mds-ai-bolit-hoster.db --procudb=/var/imunify360/files/sigs/v1/aibolit/mds-procu2.db --report-file=`pwd`/report.json --clean
</code></pre></div></div> <p>Cleanup results will be stored in the <span class="notranslate"><code>results.json</code></span>. Also, backup of the affected data will be created with a filename similar to the <span class="notranslate"><code>mds_backup_1597223818.csv</code></span>.</p> <h4 id="undo-changes-restore"><a href="#undo-changes-restore" aria-hidden="true" class="header-anchor">#</a> Undo changes (restore)</h4> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># /opt/ai-bolit/wrapper /opt/ai-bolit/imunify_dbscan.php --port=3306 --login=user --password-from-stdin --database=$DATABASE --report-file=$REPORT --restore=`pwd`/mds_backup_1597223818.csv
</code></pre></div></div> <h2 id="webshield"><a href="#webshield" aria-hidden="true" class="header-anchor">#</a> Webshield</h2> <div class="warning custom-block"><p class="custom-block-title">Warning</p><p>When the interface IP address is added to or deleted from the system, the restart of the webshield is required for the latter to recognize the new IP.</p></div><div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>service imunify360-webshield restart
</code></pre></div></div> <h3 id="captcha"><a href="#captcha" aria-hidden="true" class="header-anchor">#</a> Captcha</h3> <p>The CAPTCHA is a feature intended to distinguish human from machine input and protect websites from the spam and different types of automated abuse. Imunify360 uses <a href="https://www.google.com/recaptcha/intro/invisible.html" target="_blank" rel="noopener noreferrer">reCAPTCHA<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> service.</p> <div class="warning custom-block"><p class="custom-block-title">Warning</p><p>Please note that the WebShield Captcha is not compatible with aggressive CDN caching modes, like Cloudflare 'cache everything' with 'Edge Cache TTL'. If the Сaptcha page is cached by CDN, a visitor will see the Captcha from CDN cache disregarding it has been passed or not. In order to fix that, either disable the aggressive CDN caching or the Captcha functionality in the Imunify360.</p></div><p>There are two layers in CAPTCHA behavior:</p> <ol><li>If a user of a website is added to the <span class="notranslate">Grey List</span> (the access is blocked), then the CAPTCHA allows him to unblock himself. When he tries to get to the website he is redirected to the Captcha Server by ipset, where he can see the protection page asking to confirm that he is not a robot by ticking a checkbox.</li></ol> <p><img src="/images/captcha.jpg" alt=""></p> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>The IP address on the screenshot above is given as an example.</p></div><p>If successful, a user is redirected to the website, which means that the access is unblocked and the IP address of this user is removed from the <span class="notranslate">Grey List</span>.</p> <p>It is also possible to enable the invisible reCAPTCHA via the Imunify360 <a href="/dashboard/#settings"><span class="notranslate">Settings</span> page</a>. With the invisible reCAPTCHA enabled, a human user is not required to go through human confirmation - the process will pass under the hood and a user will be redirected to the website. In case if invisible reCAPTCHA failed to detect if a user is a human or not, then visible reCAPTCHA appears.</p> <ol start="2"><li>The CAPTCHA is always on guard of the websites and checks the activity of each IP. With the help of reCAPTCHA it blocks bots and protects websites from spam and abuse. To learn more about reCAPTCHA follow the <a href="https://www.google.com/recaptcha/intro/" target="_blank" rel="noopener noreferrer">link<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li></ol> <p>The reCaptcha supports localization. Depending on user’s browser settings, reCaptcha will use the browser default language and allow to change it:</p> <p><img src="/images/local.jpg" alt=""></p> <h4 id="captcha-page-customization"><a href="#captcha-page-customization" aria-hidden="true" class="header-anchor">#</a> Captcha page customization</h4> <p>To modify footer, header or body of the CAPTCHA use the templates in <span class="notranslate"><code>/usr/share/imunify360-webshield/captcha/templates/</code></span>.</p> <p>There are three files:</p> <ul><li><p><span class="notranslate"><code>head.tpl</code></span> – this file goes inside <span class="notranslate"><code>&lt;head&gt;&lt;/head&gt;</code></span> tags. So you can add JavaScript, CSS styles, etc.</p></li> <li><p><span class="notranslate"><code>body.tpl</code></span> – the main template file, modify it as you wish. CAPTCHA goes above all the layers.</p></li> <li><p><span class="notranslate"><code>static</code></span> – here you can place images, CSS, JavaScript, etc. and access these files as <span class="notranslate"><code>/static/&lt;filename&gt;</code></span>.</p></li></ul> <p>To find information on supported browsers follow this link <a href="https://support.google.com/recaptcha/answer/6223828" target="_blank" rel="noopener noreferrer">https://support.google.com/recaptcha/answer/6223828<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h4 id="update-captcha-localizations"><a href="#update-captcha-localizations" aria-hidden="true" class="header-anchor">#</a> Update Captcha localizations</h4> <p>A user can change the text of captcha messages for the supported languages. Note that adding custom language is not supported.</p> <p>To change the text of the Imunify360 Captcha and update the localizations text, please do the following:</p> <ol><li><p>Locate appropriate Captcha localization files by running:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>ls /usr/share/imunify360-webshield/captcha/translations/locale/{lang}/LC_MESSAGES/messages.po
</code></pre></div></div> <p>For example for Polish language the catalog looks like this:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>/usr/share/imunify360-webshield/captcha/translations/locale/pl/LC_MESSAGES/messages.po
</code></pre></div></div></li> <li><p>Update Captcha localization files by editing <span class="notranslate"><code>msgstr &quot;my customization or translation&quot;</code></span> for appropriate <span class="notranslate"><code>msgid “original plain english text&quot;</code></span>.</p> <p>Where <span class="notranslate"><code>msgstr</code></span> contains text that is shown to user and <span class="notranslate"><code>msgid</code></span> contains Captcha original English text.</p> <p>For example:</p> <div class="notranslate"><div class="language-HTML extra-class"><pre class="language-html"><code>#: templates/index.html:154
msgid &quot;&quot;
&quot;We have noticed an unusual activity from your <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span>IP {client_ip}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span> and &quot;
&quot;blocked access to this website.&quot;
msgstr &quot;&quot;
&quot;Zauważyliśmy nietypową aktywność związaną z twoim adresem <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span>IP &quot;
&quot;{client_ip}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span> i zablokowaliśmy dostęp do tej strony internetowej&quot;
</code></pre></div></div></li> <li><p>To add Polish translation edit text in the <span class="notranslate"><code>msgstr</code></span> field. To change the text for a default English translation, edit text in the <span class="notranslate"><code>msgid</code></span> field.</p></li> <li><p>Save files.</p></li> <li><p>When translation in <span class="notranslate"><code>messages.po</code></span> files is finished, restart <span class="notranslate">imunify360-webshield</span> service:</p></li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>service imunify360-webshield restart
</code></pre></div></div> <ol start="6"><li>Block yourself (remove your IP from <span class="notranslate">Imunify360 White List</span> and try to log in to the server via ssh with wrong password until it blocks you). Then go to website and log in. Captcha should appear. Set Polish language and assert that new text is displayed.</li></ol> <h4 id="changing-the-default-keys-to-google-recaptcha-keys"><a href="#changing-the-default-keys-to-google-recaptcha-keys" aria-hidden="true" class="header-anchor">#</a> Changing the default keys to Google reCAPTCHA keys</h4> <p>If a server owner has his own Google reCAPTCHA keys (both private and public), he may use them instead of the default CloudLinux keys.</p> <p>To set Google reCAPTCHA keys, place your keys into the <span class="notranslate"><code>/etc/imunify360-webshield/webshield-http.conf.d/captchakeys.conf</code></span> file as shown in the example below:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>captcha_site_key &lt;YOUR_SITE_KEY&gt;;
captcha_secret_key &lt;YOUR_SECRET_KEY&gt;;
</code></pre></div></div> <p>Then reload WebShield.</p> <h3 id="configuring-recaptcha-keys"><a href="#configuring-recaptcha-keys" aria-hidden="true" class="header-anchor">#</a> Configuring reCAPTCHA keys</h3> <p>See <a href="/dashboard/#invisible-captcha">how to setup invisible CAPTCHA</a>.</p> <h4 id="why-do-you-need-to-specify-the-google-recaptcha-keys-in-the-imunify360-product"><a href="#why-do-you-need-to-specify-the-google-recaptcha-keys-in-the-imunify360-product" aria-hidden="true" class="header-anchor">#</a> Why do you need to specify the Google reCAPTCHA keys in the Imunify360 product</h4> <p>Imunify360 admin should specify reCAPTCHA keys for the server since we’re planning to completely remove embedded reCAPTCHA keys in the future versions.</p> <p>In this article, you can find a step by step guide on how to set up a custom site and secret keys for your Imunify360 server.</p> <h4 id="how-to-specify-the-keys-for-the-imunify360-captcha"><a href="#how-to-specify-the-keys-for-the-imunify360-captcha" aria-hidden="true" class="header-anchor">#</a> How to specify the keys for the Imunify360 CAPTCHA</h4> <p>Public and secret reCAPTCHA keys are required for integration between Imunify360 and Google reCAPTCHA service.</p> <p>The site key will be publicly available and shown on pages along with reCAPTCHA widget or Invisible CAPTCHA, whereas the secret key will be stored for intercommunication between the backend of Imunify360 and Google service.</p> <div class="tip custom-block"><p class="custom-block-title">Note: Due to the captcha rate limit we recommend using different reCAPTCHA keys for each server.</p><p><a href="https://developers.google.com/recaptcha/docs/faq#are-there-any-qps-or-daily-limits-on-my-use-of-recaptcha" target="_blank" rel="noopener noreferrer">Google’s quotation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:
If you wish to make more than 1k calls per second or 1m calls per month, you must use reCAPTCHA Enterprise or fill out this form and wait for an exception approval.</p></div><h4 id="steps-to-configure"><a href="#steps-to-configure" aria-hidden="true" class="header-anchor">#</a> Steps to configure</h4> <ol><li><p>Open <a href="https://www.google.com/recaptcha/admin/create" target="_blank" rel="noopener noreferrer">https://www.google.com/recaptcha/admin/create<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p>Fill in required values</p> <ul><li>Set any value as a label, e.g. <span class="notranslate"><em>my servers cluster #1</em></span></li> <li>Select <em>reCAPTCHA v2</em></li> <li>Select <span class="notranslate"><em>Invisible reCAPTCHA badge</em></span></li> <li>Add any dummy domain, e.g. <span class="notranslate"><em>example.org</em></span></li></ul> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>You don’t need to put all your domains here</p></div><p><img src="/images/reCaptchaRegister.png" alt=""></p></li> <li><p>Accept terms and proceed</p></li> <li><p>Notice keys</p> <p><img src="/images/reCaptchaNoticeKeys.png" alt=""></p></li> <li><p>You need to put these keys on the Imunify360 settings page</p> <p><img src="/images/reCaptchaImunifyKeys.png" alt=""></p> <p>or use the following CLI commands:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># imunify360-agent config update '{&quot;WEBSHIELD&quot;: {&quot;captcha_site_key&quot;: &quot;6Ldu4XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXCN6fJ&quot;}}'

# imunify360-agent config update '{&quot;WEBSHIELD&quot;: {&quot;captcha_secret_key&quot;: &quot;6Ldu4XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXQqUuk&quot;}}'
</code></pre></div></div></li> <li><p>The final step is to allow Google to process requests from any of your domains</p> <ul><li><p>Open the <span class="notranslate"><em>Settings</em></span> page</p> <p><img src="/images/reCaptchaVerify.png" alt=""></p></li> <li><p>And disable the <span class="notranslate"><em>Verify the origin of reCAPTCHA solutions</em></span></p> <p><img src="/images/reCaptchaVerifyDisable.png" alt=""></p></li></ul></li></ol> <p>That’s it.</p> <h4 id="verification"><a href="#verification" aria-hidden="true" class="header-anchor">#</a> Verification</h4> <p>In order to make sure that you’ve done everything correctly you need to do the following:</p> <ol><li><p>Make sure that your IP is not whitelisted (using the CLI):</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># imunify360-agent whitelist ip list
IP          TTL    COUNTRY  IMPORTED_FROM  COMMENT
1.2.3.4     10256  None     None           Whitelisted for 3 hours due to successful panel login

# imunify360-agent whitelist ip delete 1.2.3.4
OK

# imunify360-agent whitelist ip list
IP          TTL    COUNTRY  IMPORTED_FROM  COMMENT
</code></pre></div></div></li> <li><p>Make sure your target domain is not <a href="/terminology/">whitelisted</a>:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># imunify360-agent whitelist domain list
example.com
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code># imunify360-agent whitelist domain delete example.com
OK
</code></pre></div></div></li> <li><p>Send at least two WAF test requests to any domain on the server</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># curl -v http://example.org/?i360test=88ff0adf94a190b9d1311c8b50fe2891c85af732
</code></pre></div></div></li> <li><p>Open your test domain in the browser and let it pass the captcha challenge</p></li> <li><p>Check the list of whitelisted IPs again</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># imunify360-agent whitelist ip list
IP          TTL    COUNTRY  IMPORTED_FROM  COMMENT
1.2.3.4     86377  None     None           IP auto-whitelisted with expiration date: 2020-05-28 15:29:34

</code></pre></div></div></li></ol> <p>If you see that your IP is whitelisted then integration between Imunify360 and reCAPTCHA service was <strong>done properly</strong>.</p> <p>You can watch how invisible reCAPTCHA works at <a href="https://www.youtube.com/watch?v=GQXmAj5hyDo" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=GQXmAj5hyDo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>It is also possible to test Captcha by the server IP. Find more information <a href="/faq_and_known_issues/#_20-how-to-check-that-captcha-works">here</a></p></div><h3 id="cdn-support"><a href="#cdn-support" aria-hidden="true" class="header-anchor">#</a> CDN Support</h3> <p>Imunify360 correctly graylists and blocks IPs behind Cloudflare and other CDNs (see <a href="/webshield/#supported-cdn-providers">here</a> for the full list).</p> <p>Imunify360 passes all requests from CDN through <span class="notranslate">WebShield</span>, and uses <span class="notranslate">CF-Connecting-IP</span> and <span class="notranslate">X-Forwarded-For</span> headers to identify real IPs.</p> <p>To enable it now, run the command:</p> <div class="notranslate"><div class="language-sh extra-class"><pre class="language-sh"><code>imunify360-agent config update <span class="token string">'{&quot;WEBSHIELD&quot;: {&quot;known_proxies_support&quot;: true}}'</span>
</code></pre></div></div> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>If you are using cPanel/EasyApache3, Imunify360 will not automatically deploy <em>mod_remoteip</em>, and log files will show local server IP for visitors coming from CDN. EasyApache 3 is EOL since December 2018, and we don't plan to add automated <em>mod_remoteip</em> setup and configuration for it.</p></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>For cPanel/EasyApache 4, Plesk, DirectAdmin and LiteSpeed <em>mod_remoteip</em> will be automatically installed and configured.</p></div><h4 id="supported-cdn-providers"><a href="#supported-cdn-providers" aria-hidden="true" class="header-anchor">#</a> Supported CDN providers:</h4> <ul><li>Cloudflare</li> <li>MaxCDN</li> <li>StackPath CDN</li> <li>KeyCDN</li> <li>Dartspeed.com</li> <li>QUIC.cloud CDN</li> <li>NuCDN</li> <li>Google CDN</li> <li>CloudFront CDN</li> <li>GoCache CDN</li> <li>Opera</li> <li>QUANTIL</li> <li>QUIC.cloud CDN</li> <li>BunnyCDN</li> <li>Sucuri WAF</li> <li>Ezoic</li></ul> <h4 id="how-to-trust-all-ips-that-are-specified-by-ezoic-cdn"><a href="#how-to-trust-all-ips-that-are-specified-by-ezoic-cdn" aria-hidden="true" class="header-anchor">#</a> How to trust all IPs that are specified by Ezoic CDN</h4> <p>The “trust_ezoic” option for WebShield allows you to trust all IPs that are specified by Ezoic CDN as their own servers. By default the option is switched off, but it can be switched on in a straightforward way. Be aware when using this option, at this moment the list of Ezoic CDN servers is quite big and includes ranges that can be controlled by someone else in Amazon EC2.</p> <p>To enable it, open the <code>/etc/imunify360-webshield/virtserver.conf</code> file, find the directive set</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>$trust_ezoic 0;
</code></pre></div></div> <p>replace <code>0</code> with <code>1</code>, save the file and restart WebShield, using the following command:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># service imunify360-webshield restart
</code></pre></div></div> <h4 id="splashscreen-for-chinese-customers"><a href="#splashscreen-for-chinese-customers" aria-hidden="true" class="header-anchor">#</a> SplashScreen for Chinese customers</h4> <p>Imunify360 Captcha isn't available in some countries due to certain restrictions, for example, in China. To alleviate this, Chinese customers can use Imunify360 SplashScreen as Captcha.</p> <p>To enable SplashScreen, open the file <span class="notranslate"><code>/etc/imunify360-webshield/wscheck.conf</code></span>, find the following line:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>wscheck_splashscreen_as_captcha off;
</code></pre></div></div> <p>Change <span class="notranslate"><code>off</code></span> to <span class="notranslate"><code>on</code></span>:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>wscheck_splashscreen_as_captcha on;
</code></pre></div></div> <p>Save the file and run the following command:</p> <p><strong>For Ubuntu:</strong></p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>service imunify360-websheld reload
</code></pre></div></div> <p><strong>For CentOS:</strong></p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>systemctl reload imunify360-webshield
</code></pre></div></div> <p>The graylisted visitors will see such screen for 5 seconds before redirecting to their initial destination.</p> <p><img src="/images/splash_as_captcha.png" alt=""></p> <div class="warning custom-block"><p class="custom-block-title">Note</p><p>You can find WebShield and Captcha related logs in the <span class="notranslate"><code>/var/log/imunify360-webshield/</code></span> file.</p></div><h4 id="how-to-block-attacks-from-a-particular-country-in-webshield"><a href="#how-to-block-attacks-from-a-particular-country-in-webshield" aria-hidden="true" class="header-anchor">#</a> How to block attacks from a particular country in WebShield</h4> <p>Country blocking is available in both <a href="/dashboard/#black-list">Admin UI</a> and <a href="/command_line_interface/#blacklist">CLI</a></p> <h3 id="using-cloudflare-cache-everything-with-imunify360"><a href="#using-cloudflare-cache-everything-with-imunify360" aria-hidden="true" class="header-anchor">#</a> Using Cloudflare “Cache Everything” with Imunify360</h3> <p>According to the <a href="https://developers.cloudflare.com/support/page-rules/understanding-and-configuring-cloudflare-page-rules-page-rules-tutorial/#summary-of-page-rules-settings" target="_blank" rel="noopener noreferrer">Cloudflare documentation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, <strong>Cache Everything</strong> with <strong>Edge Cache TTL</strong> enabled makes Cloudflare ignore all origin cache-related headers (see attached screenshots) which in the past, caused issues by custom cache settings in the Cloudflare control panel resulting in the inability to pass the Captcha causing an endless loop:</p> <p><img src="/assets/img/CFPageRulesListExample.dbfa60be.png" alt=""> <img src="/assets/img/EditCFRuleCacheEverythngEdgeCacheTTL.45a63fae.png" alt=""></p> <div class="tip custom-block"><p class="custom-block-title">Quote:</p><p>Level <strong>“Cache Everything”</strong> – Treats all content as static and caches all file types beyond the <a href="https://developers.cloudflare.com/cache/concepts/default-cache-behavior/" target="_blank" rel="noopener noreferrer">Cloudflare default cached content<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Respects cache headers from the origin web server unless <strong>Edge Cache TTL</strong> is also set in the Page Rule. When combined with an <strong>Edge Cache TTL</strong> &gt; 0, <strong>Cache Everything</strong> removes cookies from the origin web server response.</p></div><p>Setting Edge Cache TTL along with the Cache Everything option is not recommended though it should not create any issues now because Captcha is already disabled for Cloudflare IPs by default. It is possible to enable Captcha as long as you either:</p> <ul><li>don’t use <a href="https://developers.cloudflare.com/cache/about/edge-browser-cache-ttl/#edge-cache-ttl" target="_blank" rel="noopener noreferrer">“Edge Cache TTL”<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> + <a href="https://developers.cloudflare.com/cache/how-to/create-page-rules/#cache-everything" target="_blank" rel="noopener noreferrer">“Cache Everything”<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> in Cloudflare</li> <li>or use “Edge Cache TTL” but add a page rule that would prevent Cloudflare from caching pages with a cookie <span class="notranslate"><code>cl-bypass-cache: yes</code></span> (<a href="https://developers.cloudflare.com/support/page-rules/understanding-and-configuring-cloudflare-page-rules-page-rules-tutorial/#bypass-cache-on-cookie-setting" target="_blank" rel="noopener noreferrer">“Bypass Cache on Cookie”<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>)</li></ul> <ol><li>Edit the file <span class="notranslate"><code>/etc/imunify360-webshield/wscheck.conf</code></span></li> <li>Set <span class="notranslate"><code>cloudflare_captcha on;</code></span></li> <li>Run <span class="notranslate"><code>systemctl reload imunify360-webshield</code></span></li></ol> <h3 id="anti-bot-protection"><a href="#anti-bot-protection" aria-hidden="true" class="header-anchor">#</a> Anti-bot protection</h3> <p>Starting from version 5.6, Imunify360 distinguishes bots from real visitors using the JavaScript challenge <span class="notranslate">&quot;Splash Screen</span>.&quot; Most bots don’t solve the challenge, and their requests will not reach web applications such as WordPress, Drupal, and others. This can save the server’s resources and protects websites from scanners, automated attacks, and web-spammers.</p> <p>Only bad actors will be redirected to the Imunify360 <span class="notranslate">Splash Screen</span> challenge page. Legitimate visitors get original content without any verification page nor any delay. The users forced to the <span class="notranslate">Splash Screen</span> will not see the challenge or CAPTCHA and be redirected to the page with the original content. Cookies and JavaScript support are required in a browser to successfully pass the challenge of <span class="notranslate">Anti-bot protection</span>.</p> <p>The “Anti-bot protection” feature will not block legitimate bots (e.g., Google crawler).</p> <p>You can enable <span class="notranslate">Anti-bot protection</span>, in the UI. Go to the <span class="notranslate">General</span> tab -&gt; <span class="notranslate">Settings</span> and check the <span class="notranslate">Anti-bot protection</span> checkbox. You can find the details <a href="/dashboard/#anti-bot-protection">here</a>.</p> <p>Or via CLI. To do so, run the following command:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># imunify360-agent config update '{&quot;WEBSHIELD&quot;: {&quot;splash_screen&quot;: true}}'
</code></pre></div></div> <h2 id="overridable-config"><a href="#overridable-config" aria-hidden="true" class="header-anchor">#</a> Overridable config</h2> <p>Starting from Imunify360 v.5.8, we introduce the overridable config which provides the ability to provision default config for the whole fleet of Imunify servers and keep the ability for fine-tuning each particular server depending on its requirements.</p> <p><strong>Configs organization</strong>:</p> <ul><li>A new directory for custom configs. The local overrides of Imunify360 config are put there: <span class="notranslate"><code>/etc/sysconfig/imunify360/imunify360.config.d/</code></span></li> <li>The old config <span class="notranslate"><code>/etc/sysconfig/imunify360/imunify360.config</code></span> is now linked to the <span class="notranslate"><code>imunify360.config.d/90-local.config</code></span>. It contains changes made through UI as well as through CLI.</li> <li>Default Imunify360 configuration is written at <code>imunify360.config.defaults.example</code>. Modifying this config won't affect config merging behavior in any way, so please refrain from changing it.</li> <li>Configs in that directory will override the <span class="notranslate"><code>imunify360.config.defaults.example</code></span> and each other in lexical order. First-level &quot;sections&quot; (such as <span class="notranslate"><code>FIREWALL</code></span>) are merged, while second-level &quot;options&quot; (such as <span class="notranslate"><code>FIREWALL.TCP_IN_IPv4</code></span>) are replaced completely.</li> <li><span class="notranslate"><code>imunify360.config.d/10_on_first_install.config</code></span> is a config that is supplied by Imunify360. Its purpose is to let us - Imunify360 developers - enable new features only on new installations without forcing existing installation to see new feature enabled on the update. This config should not be modified manually.</li></ul> <p>This way you can keep your local customizations, and still be able to rollout your main config.</p> <p>The following CLI command can be used to check current server configuration:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent config show
</code></pre></div></div> <p>Current server configuration is also present at <span class="notranslate"><code>/etc/sysconfig/imunify360/imunify360-merged.config</code></span> path.</p> <p>The following CLI command:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent config show defaults
</code></pre></div></div> <p>can be used to check server configuration in the following states:</p> <ul><li><span class="notranslate"><code>mutable_config</code></span> represents config state before applying <span class="notranslate"><code>imunify360.config.d/90-local.config</code></span>,</li> <li><span class="notranslate"><code>local_config</code></span> represents parsed <span class="notranslate"><code>imunify360.config.d/90-local.config</code></span> config,</li> <li><span class="notranslate"><code>immutable_config</code></span> represents merged configs which come after <span class="notranslate"><code>imunify360.config.d/90-local.config</code></span> in lexical order.</li></ul> <p>Here is an example of custom server configuration:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>imunify360.config.defaults.example</code></span><br><br>Provided by Imunify installation. Contains default recommended configuration</td> <td><span class="notranslate"><code>FIREWALL:</code></span><br><span class="notranslate"><code>TCP_IN_IPv4:</code></span><br><code>- '20'</code><br><code>- '8880'</code><br><span class="notranslate"><code>port_blocking_mode: ALLOW</code></span></td></tr> <tr><td><span class="notranslate"><code>imunify360.config.d/50-common.config</code></span><br><br>Provisioned by server owner to the fleet of servers.</td> <td><span class="notranslate"><code>FIREWALL:</code></span><br><span class="notranslate"><code>TCP_IN_IPv4:</code></span><br><code>- '20'</code><br><code>- '21'</code><br><span class="notranslate"><code>port_blocking_mode: DENY</code></span></td></tr> <tr><td><span class="notranslate"><code>imunify360.config.d/90-local.config</code></span><br><br>Contains local customization per server individually.</td> <td><span class="notranslate"><code>FIREWALL:</code></span><br><span class="notranslate"><code>TCP_IN_IPv4:</code></span><br><code>- '20'</code><br><code>- '22'</code><br><code>- '12345'</code></td></tr></tbody></table> <p>The resulting (merged) configuration will look like this:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>FIREWALL:
  TCP_IN_IPv4:
  - '20'
  - '22'
  - '12345'
  port_blocking_mode: DENY
</code></pre></div></div> <p>The mechanics is as follows: first-level &quot;sections&quot; - for example <span class="notranslate"><code>FIREWALL</code></span> are merged, while second-level &quot;options&quot; - for example <span class="notranslate"><code>FIREWALL.TCP_IN_IPv4</code></span> are replaced completely.</p> <p>Those who don’t need this type of overridable configs can continue using custom configurations in the <span class="notranslate"><code>/etc/sysconfig/imunify360/imunify360.config</code></span>.</p> <p>This feature is backward compatible.</p> <h2 id="scan-of-the-system-and-user-crontab-files-for-malicious-jobs"><a href="#scan-of-the-system-and-user-crontab-files-for-malicious-jobs" aria-hidden="true" class="header-anchor">#</a> Scan of the system and user crontab files for malicious jobs <span class="badge note" style="vertical-align:top;" data-v-17014d78>Experimental</span></h2> <p>On the web server, the user’s Crontab files are notoriously tricky to maintain secure because of specific format and various placement of the files outside of users’ home directories depending on specific OS and platform, which makes them a compelling target for malicious actors.</p> <p>This feature detects any Crontab infection among the files that are owned by users of the server for every role that has access to run the scans on that server.</p> <p>The feature is available as experimental starting from Imunify360 version 6.10 and switched off by default.</p> <p>The setting <code>MALWARE_SCANNING.crontabs</code> allows you to enable or disable scan of the system and user crontab files for malicious jobs.</p> <p>Manage it through CLI:</p> <p>To switch it on:</p> <div class="language- extra-class"><pre class="language-text"><code># imunify360-agent config update '{&quot;MALWARE_SCANNING&quot;: {&quot;crontabs&quot;: true}}' 
</code></pre></div><p>And to switch it off:</p> <div class="language- extra-class"><pre class="language-text"><code># imunify360-agent config update '{&quot;MALWARE_SCANNING&quot;: {&quot;crontabs&quot;: false}}'
</code></pre></div><h2 id="hooks"><a href="#hooks" aria-hidden="true" class="header-anchor">#</a> Hooks <span class="badge warning" style="vertical-align:top;" data-v-17014d78>Deprecated</span></h2> <p>You can use a new notification system via <a href="/command_line_interface/#notifications-config">CLI</a> and <a href="/features/#notifications">UI</a>.</p> <h3 id="overview"><a href="#overview" aria-hidden="true" class="header-anchor">#</a> Overview</h3> <p>Hooks are introduced as a script-based interface for various application events. This is a simple and effective way to automate Imunify360 alerts and event processing.
For example, an administrator can have Imunify360 calling his own script when malicious files are detected or misconfigurations are detected and perform a custom processing or specific actions, for example, create a ticket.
Hooks are available only via CLI.</p> <h4 id="requirements"><a href="#requirements" aria-hidden="true" class="header-anchor">#</a> Requirements</h4> <ul><li>You can use any programming language to create a hook script</li> <li>A hook script should be executable</li> <li>For Native hooks, you should use Python 3.5 only</li></ul> <h3 id="how-to-start-using-hooks"><a href="#how-to-start-using-hooks" aria-hidden="true" class="header-anchor">#</a> How to start using hooks</h3> <p>Start using hooks with three simple steps:</p> <ol><li><p>Create a script to handle an event (a hook handler):</p> <ul><li>you can use our <a href="/features/#structure-and-examples-of-a-hook-script">scripts example</a> as a template</li> <li><a href="/features/#available-events-and-their-parameters">the following events are available</a></li></ul></li> <li><p>Register your hook handler in Imunify360 agent - use registration command:</p></li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent hook add --event &lt;event name&gt; --path &lt;/path/to/hook_script&gt;
</code></pre></div></div> <ol start="3"><li>Once the event added - check results and the <a href="/features/#log-file">log file</a></li></ol> <h3 id="available-events-and-their-parameters"><a href="#available-events-and-their-parameters" aria-hidden="true" class="header-anchor">#</a> Available events and their parameters</h3> <h4 id="agent"><a href="#agent" aria-hidden="true" class="header-anchor">#</a> agent</h4> <ul><li>subtype ( started | misconfig )
<ul><li><p>started - the event is generated each time the Imunify agent is started/restarted</p> <ul><li>params[]
<ul><li>version / string / version of agent</li></ul></li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{&quot;version&quot;: &quot;4.6.2-2&quot;}
</code></pre></div></div></li> <li><p>misconfig - the event is generated when the agent detects agent misconfiguration / broken settings / etc.</p> <ul><li>params[]
<ul><li>error / string / error message where / what type of misconfiguration was detected and some details</li></ul></li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{
&quot;error&quot;: &quot;ValidationError({'SMTP_BLOCKING': [{'allow_groups': ['must be of list type']}]},)&quot;
}
</code></pre></div></div></li></ul></li></ul> <h4 id="malware-scanning"><a href="#malware-scanning" aria-hidden="true" class="header-anchor">#</a> malware-scanning</h4> <ul><li><p>subtype ( started | finished )</p> <ul><li><p><strong>started</strong> - the event is generated when the malware scanning process is started (for on-demand and background scans only, yet not the ftp / waf / inotify)</p> <ul><li>params[]
<ul><li>scan_id / string / identifier of running scan</li> <li>path / string / path that’s scanning</li> <li>started / int / unixtime when scan started</li> <li>scan_type / string / type of scanning (“on-demand”, “background”, “ftp”, “rescan“)</li> <li>scan_params[]  / initial scanning params
<ul><li>file_patterns / string / file mask to scan</li> <li>exclude_patterns / string / file mask to ignore</li> <li>follow_symlinks / boolean / shall scanner follow symlinks</li> <li>intensity_cpu / int / intensity for cpu operations (from 1 to 7)</li> <li>intensity_io / int / intensity for IO operations (from 1 to 7)</li> <li>intensity_ram / int / amount of memory allocated to the scan process in MB</li></ul></li></ul></li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{
    &quot;scan_id&quot;: &quot;dc3c6061c572410a83be19d153809df1&quot;,
    &quot;home&quot;: &quot;/home/a/abdhf/&quot;,
    &quot;user&quot;: &quot;abdhf&quot;,
    &quot;type&quot;: &quot;background&quot;,
    &quot;scan_params&quot;: {
        &quot;file_patterns&quot;: &quot;*&quot;,
        &quot;exclude_patterns&quot;: null,
        &quot;follow_symlinks&quot;: true,
        &quot;intensity_cpu&quot;: 2
        &quot;intensity_io&quot;: 2
        &quot;intensity_ram&quot;: 2048
    }
}
</code></pre></div></div></li> <li><p><strong>finished</strong> - the event is generated when the malware scanning process is finished (for on-demand and background scans only, yet not the ftp / waf / inotify)</p> <ul><li>params[]
<ul><li>scan_id / string / identifier of running scan</li> <li>path / string / path that’s scanned</li> <li>started / int / unixtime when scan started</li> <li>scan_type / string / type of scanning (“on-demand”, “background”, “ftp”, “rescan“)</li> <li>total_files / int / total number of files that were scanned</li> <li>total_malicious / int / number of detected malicious files</li> <li>error / string / error message if any occurred during scanning</li> <li>status / string / status of scan (“ok”, “failed”)</li> <li>users[] / string array/ user that’s scanned</li> <li>scan_params[]  / initial scanning params
<ul><li>file_patterns / string / file mask to scan</li> <li>exclude_patterns / string / file mask to ignore</li> <li>follow_symlinks / boolean / shall scanner follow symlinks</li> <li>intensity_cpu / int / intensity for cpu operations (from 1 to 7)</li> <li>intensity_io / int / intensity for IO operations (from 1 to 7)</li> <li>intensity_ram / int / amount of memory allocated to the scan process in MB</li></ul></li></ul></li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{
    &quot;scan_id&quot;: &quot;dc3c6061c572410a83be19d153809df1&quot;,
    &quot;path&quot;: &quot;/home/a/abdhf/&quot;,
    &quot;started&quot;: 1587365282,
    &quot;scan_type&quot;: &quot;background&quot;,
    &quot;total_files&quot;: 873535,
    &quot;total_malicious&quot;: 345,
    &quot;error&quot;: null,
    &quot;status&quot;: &quot;ok&quot;,
    &quot;users&quot;: [&quot;abdhf&quot;],
    &quot;scan_params&quot;: {
        &quot;file_patterns&quot;: &quot;*&quot;,
        &quot;exclude_patterns&quot;: null,
        &quot;follow_symlinks&quot;: true,
        &quot;intensity_cpu&quot;: 2
        &quot;intensity_io&quot;: 2
        &quot;intensity_ram&quot;: 2048
    }
}
</code></pre></div></div></li></ul></li></ul> <h4 id="malware-detected"><a href="#malware-detected" aria-hidden="true" class="header-anchor">#</a> malware-detected</h4> <ul><li>subtype ( critical )
<ul><li><p><strong>critical</strong></p> <ul><li>params[]
<ul><li>scan_id / string / unique id of the scan</li> <li>scan_type / string / type of scanning (“on-demand”, “background”, “ftp”, “rescan“)</li> <li>error / string / error message if any occurred during scanning</li> <li>started / int / unixtime when the scan was started</li> <li>path / string / path that was scanned</li> <li>users[] / string array / users that have been scanned (if any)</li> <li>total_files / int / number of files checked within the last scanning</li> <li>total_malicious / int / number of detected malicious files</li> <li>tmp_filename / string / path to a temporary file with a list of detected threads. The list of threads is in the format of the following command: <span class="notranslate"><code>imunify360-agent malware malicious list --by-scan-id=... --json</code></span></li></ul></li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{
    &quot;scan_id&quot;: &quot;dc3c6061c572410a83be19d153809df1&quot;,
    &quot;scan_type&quot;: &quot;on-demand&quot;,
    &quot;path&quot;: &quot;/home/a/abdhf/&quot;,
    &quot;users&quot;: [
        &quot;imunify&quot;,
        &quot;u1&quot;
    ],
    &quot;started&quot;: 1587365282,
    &quot;total_files&quot;: 873535,
    &quot;total_malicious&quot;: 345,
    &quot;error&quot;: null,
    &quot;tmp_filename&quot;: &quot;/var/imunify360/tmp/malware_detected_critical_sldkf2j.json&quot;
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>[
    {
      &quot;scan_id&quot;: &quot;dc3c6061c572410a83be19d153809df1&quot;,
      &quot;username&quot;: &quot;imunify&quot;,
      &quot;hash&quot;: &quot;17c1dd3659578126a32701bb5eaccecc2a6d8307d8e392f5381b7273bfb8a89d&quot;,
      &quot;size&quot;: &quot;182&quot;,
      &quot;cleaned_at&quot;: 1553762878.6882641,
      &quot;extra_data&quot;: {


      },
      &quot;malicious&quot;: true,
      &quot;id&quot;: 32,
      &quot;status&quot;: &quot;cleanup_removed&quot;,
      &quot;file&quot;: &quot;/home/imunify/public_html/01102018_2.php&quot;,
      &quot;type&quot;: &quot;SMW-INJ-04174-bkdr&quot;,
      &quot;scan_type&quot;: &quot;on-demand&quot;,
      &quot;created&quot;: 1553002672
    },
    {
      &quot;scan_id&quot;: &quot;dc3c6061c572410a83be19d153809df1&quot;,
      &quot;username&quot;: &quot;imunify&quot;,
      &quot;hash&quot;: &quot;04425f71ae6c3cd04f8a7f156aee57096dd658ce6321c92619a07e122d33bd32&quot;,
      &quot;size&quot;: &quot;12523&quot;,
      &quot;cleaned_at&quot;: 1553762878.6882641,
      &quot;extra_data&quot;: {


      },
      &quot;malicious&quot;: true,
      &quot;id&quot;: 33,
      &quot;status&quot;: &quot;cleanup_done&quot;,
      &quot;file&quot;: &quot;/home/imunify/public_html/22.js&quot;,
      &quot;type&quot;: &quot;SMW-INJ-04346-js.inj&quot;,
      &quot;scan_type&quot;: &quot;on-demand&quot;,
      &quot;created&quot;: 1553002672
    },
...
]
</code></pre></div></div></li></ul></li></ul> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>All results can be saved in a temporary file before handler invocation and then remove the file after the event is being processed</p></div><h4 id="malware-cleanup"><a href="#malware-cleanup" aria-hidden="true" class="header-anchor">#</a> malware-cleanup</h4> <ul><li><p>subtype ( started | finished )</p> <ul><li><p><strong>started</strong> - the event is generated when the malware cleanup process is started (for on-demand and background cleanup only, background auto-cleanup will be implemented later)</p> <ul><li>params[]
<ul><li>cleanup_id / string / unique id of the cleanup</li> <li>started / int / unixtime when the cleanup was started</li> <li>tmp_filename / string / path to a temporary file with a scanning report. The list is in the format of the following command: <span class="notranslate"><code>imunify360-agent malware malicious list --by-scan-id=... --json</code></span>. See malware-detected hook section for details.</li> <li>total_files / int / number of files that were sent for cleanup</li></ul></li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{
    &quot;cleanup_id&quot;: &quot;dc3c6061c572410a83be19d153809df1&quot;,
    &quot;started&quot;: 1587365282,
    &quot;total_files&quot;: 873535,
    &quot;tmp_filename&quot;: &quot;/var/imunify/tmp/hooks/tmp_02q648234692834698456728439587245.json&quot;,
}
</code></pre></div></div></li> <li><p><strong>finished</strong> - the event is generated when the malware scanning process is finished (for on-demand and background cleanup only, background auto-cleanup will be implemented later)</p> <ul><li>params[]
<ul><li>cleanup_id / string / identifier of running cleanup</li> <li>started / int / unixtime when cleanup started</li> <li>total_files / int / number of files that were sent for cleanup</li> <li>total_cleaned / int / number of files that were successfully cleaned</li> <li>tmp_filename / string / path to a temporary file with a list of results.</li> <li>error / string / error message if any occurred during cleanup</li> <li>status / string / status of scan (“ok”, “failed”)</li></ul></li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{
    &quot;cleanup_id&quot;: &quot;dc3c6061c572410a83be19d153809df1&quot;,
    &quot;started&quot;: 1587365282,
    &quot;total_files&quot;: 873535,
    &quot;total_cleaned&quot;: 872835,
    &quot;tmp_filename&quot;: &quot;/var/imunify/tmp/malware_cleanup_finished_slkj2f.json&quot;,
    &quot;error&quot;: null,
    &quot;status&quot;: &quot;ok&quot;
}
</code></pre></div></div></li></ul></li></ul> <h4 id="license"><a href="#license" aria-hidden="true" class="header-anchor">#</a> license</h4> <ul><li><p>subtype ( expiring | expired | renewed )</p> <ul><li><strong>expiring</strong> - the event is generated when license is about to expire, the even should be sent 3 days prior to expiration
<ul><li><p>params[]</p> <ul><li><strong>exp_time</strong> / int / unixtime data when the license expired</li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{&quot;exp_time&quot;: 1587365282}
</code></pre></div></div></li></ul></li> <li><strong>expired</strong> - the event is generated when license has expired
<ul><li><p>params[]</p> <ul><li><strong>exp_time</strong> / int / unixtime data when the license is expired</li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{&quot;exp_time&quot;: 1587365282}
</code></pre></div></div></li></ul></li> <li><strong>renewed</strong> - the event is generated when the license is updated (renewed)
<ul><li><p>params[]</p> <ul><li><strong>exp_time</strong> / int / unixtime data when the license will expire</li> <li><strong>license</strong> / string / license type</li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{
  &quot;exp_time&quot;: 1587365282,
  &quot;license&quot;: &quot;imunify360&quot;
}
</code></pre></div></div></li></ul></li></ul></li></ul> <h3 id="cli"><a href="#cli" aria-hidden="true" class="header-anchor">#</a> CLI</h3> <p>The following CLI command is used to manage hooks:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent hook [command] --event [event_name|all] [--path &lt;/path/to/hook_script&gt;]
</code></pre></div></div> <p>The following commands are supported:</p> <ul><li><span class="notranslate"><strong>add</strong></span> - register a new event handler</li> <li><span class="notranslate"><strong>delete</strong></span> - unregister existing event handler</li> <li><span class="notranslate"><strong>list</strong></span> - show existing event handlers</li> <li><span class="notranslate"><strong>add-native</strong></span> - register a new native event handler</li></ul> <p>The third parameter <span class="notranslate"><em>event_name</em></span> defines a particular event that invokes a registered handler as opposed to <span class="notranslate"><strong>all</strong></span> keyword.
The fourth parameter <code>/path/to/hook_script</code> shall contain a valid path to a handler of the event, it shall be any executable or Python Native event handlers that agent will run upon a registered event.</p> <h3 id="native"><a href="#native" aria-hidden="true" class="header-anchor">#</a> Native</h3> <p>Native hook is a script written on Python 3.5 and allows to quickly process events. The Python file should contain only one method that customer would implement:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>def im_hook(dict_param):
  …
  pass
</code></pre></div></div> <p>where <code>dict_param</code> would hold the same data as JSON that non-Native hook would get.</p> <h3 id="log-file"><a href="#log-file" aria-hidden="true" class="header-anchor">#</a> Log File</h3> <p>You can see all hook data in the log file. It is located at <span class="notranslate"><em>/var/log/imunify360/hook.log</em></span> .
When the event comes, the data is recorded to the log file in the following format:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>timestamp event : id : started [native:] name :  subtype : script_path
</code></pre></div></div> <ul><li><span class="notranslate"><strong>native</strong></span> is prepended for the Native hook implementation</li> <li><span class="notranslate"><strong>id</strong></span> is a unique ID for each event</li></ul> <p>Once the listener is done, the data is recorded to the log file in the following format:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>timestamp event : id : done [native:] script_path [OK|ERROR:code]
</code></pre></div></div> <p>In case of an error, you can see the error code you have specified.</p> <h3 id="structure-and-examples-of-a-hook-script"><a href="#structure-and-examples-of-a-hook-script" aria-hidden="true" class="header-anchor">#</a> Structure and examples of a hook script</h3> <p>Regular (non-native) hook:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>#!/bin/bash

data=$(cat)

event=$(jq -r '.event' &lt;&lt;&lt; ${data})
subtype=$(jq -r '.subtype' &lt;&lt;&lt; ${data})

case ${event} in
    malware-scanning)
        case ${subtype} in
            started)
                # do stuff here
            ;;
            *)
                echo &quot;Unhandled subtype: ${subtype}&quot; 1&gt;&amp;2
                exit 1
        esac
        ;;
    *)
        echo &quot;Unhandled event: ${event}/${subtype}&quot; 1&gt;&amp;2
        exit 2
esac
</code></pre></div></div> <p>Native hook:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>def im_hook(dict_param):
   event = dict_param['event']
   subtype = dict_param['subtype']

   if event == 'malware-scanning':
       if subtype == 'started':
           # do stuff here
           pass
       elif subtype == 'finished':
           # do other stuff here
           pass
       else:
           raise Exception('Unhandled subtype {}'.format(subtype))
   else:
       raise Exception('Unhandled event {}'.format(event))
</code></pre></div></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/cloudlinux/imunify360-doc/edit/dev/docs/features/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="back-to-top" data-v-c64d4a1e><a class="nav-arrow top back-to-top__link" data-v-c64d4a1e></a></div> </div> <div class="footer" data-v-671babf6><div data-v-671babf6><a href="https://cloudlinux.com" data-v-671babf6><img src="/assets/img/we-are-cloudlinux.783ed390.svg" alt="We are Cloudlinux" data-v-671babf6></a></div> <div class="footer-company-title" data-v-671babf6>2023. CloudLinux Inc</div> <div data-v-671babf6><div data-v-671babf6><a href="https://cloudlinux.zendesk.com/hc/en-us/categories/360002375980-Imunify-Security-Products" target="_blank" data-v-671babf6>How to</a></div><div data-v-671babf6><a href="https://www.imunify360.com/getting-started" target="_blank" data-v-671babf6>Getting started</a></div><div data-v-671babf6><a href="https://cloudlinux.zendesk.com/hc/en-us/requests/new" target="_blank" data-v-671babf6>Submit request</a></div><div data-v-671babf6><a href="https://blog.imunify360.com" target="_blank" data-v-671babf6>Blog</a></div></div> <div class="social" data-v-671babf6><span class="footer-social-text" data-v-671babf6>Stay in touch</span> <a href="https://www.facebook.com/imunify360/" target="_blank" data-v-671babf6><img src="/fb.png" class="footer-social-logo" data-v-671babf6></a><a href="https://twitter.com/imunify360/" target="_blank" data-v-671babf6><img src="/tw.png" class="footer-social-logo" data-v-671babf6></a><a href="https://linkedin.com/company/cloudlinux" target="_blank" data-v-671babf6><img src="/in.png" class="footer-social-logo" data-v-671babf6></a><a href="https://www.youtube.com/channel/UCcW6dDJjcy41c7Hl_5LdLZQ" target="_blank" data-v-671babf6><img src="/ytube.png" class="footer-social-logo" data-v-671babf6></a></div></div> <!----></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.3abfcf7c.js" defer></script><script src="/assets/js/5.92c348f6.js" defer></script><script src="/assets/js/1.443374ed.js" defer></script><script src="/assets/js/22.10ceb554.js" defer></script><script src="/assets/js/21.53b2588b.js" defer></script><script src="/assets/js/2.8a6413a2.js" defer></script>
  </body>
</html>
