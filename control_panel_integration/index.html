<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Control panel integration | Documentation</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/favicon.ico">
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5MC2SNS');</script>
    <meta name="description" content="Imunify360 can be installed directly on the server, independent of any panel, regardless of the administrative interface.">
    <meta name="twitter:title" content="Control panel integration">
    <meta name="twitter:description" content="Imunify360 can be installed directly on the server, independent of any panel, regardless of the administrative interface.">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:url" content="https://docs.imunify360.com/control_panel_integration/">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Control panel integration">
    <meta property="og:description" content="Imunify360 can be installed directly on the server, independent of any panel, regardless of the administrative interface.">
    <meta property="og:url" content="https://docs.imunify360.com/control_panel_integration/">
    <meta property="og:site_name" content="Imunify 360 Documentation">
    <meta itemprop="name" content="Control panel integration">
    <meta itemprop="description" content="Imunify360 can be installed directly on the server, independent of any panel, regardless of the administrative interface.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="referrer" content="unsafe-url">
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline' 'unsafe-inline' 'unsafe-eval' *.survicate.com *.googletagmanager.com *.google-analytics.com *.licdn.com *.hotjar.com *.twitter.com *.facebook.net *.kernelcare.info *.twitter.com *.ads-twitter.com;">
    <link rel="preload" href="/assets/css/0.styles.c63e9006.css" as="style"><link rel="preload" href="/assets/js/app.e0653151.js" as="script"><link rel="preload" href="/assets/js/5.92c348f6.js" as="script"><link rel="preload" href="/assets/js/1.443374ed.js" as="script"><link rel="preload" href="/assets/js/28.39653462.js" as="script"><link rel="preload" href="/assets/js/2.8a6413a2.js" as="script"><link rel="prefetch" href="/assets/js/10.4eacd74a.js"><link rel="prefetch" href="/assets/js/11.7d916a01.js"><link rel="prefetch" href="/assets/js/12.ef059b28.js"><link rel="prefetch" href="/assets/js/13.4dba68c3.js"><link rel="prefetch" href="/assets/js/14.aecb78d4.js"><link rel="prefetch" href="/assets/js/15.de35870b.js"><link rel="prefetch" href="/assets/js/16.dfa2deed.js"><link rel="prefetch" href="/assets/js/17.0a7484c5.js"><link rel="prefetch" href="/assets/js/18.f5d09701.js"><link rel="prefetch" href="/assets/js/19.72baf214.js"><link rel="prefetch" href="/assets/js/20.ff3272c9.js"><link rel="prefetch" href="/assets/js/21.53b2588b.js"><link rel="prefetch" href="/assets/js/22.10ceb554.js"><link rel="prefetch" href="/assets/js/23.cd8734aa.js"><link rel="prefetch" href="/assets/js/24.46e2e4de.js"><link rel="prefetch" href="/assets/js/25.5e9168a6.js"><link rel="prefetch" href="/assets/js/26.41abb43b.js"><link rel="prefetch" href="/assets/js/27.19a9a1fc.js"><link rel="prefetch" href="/assets/js/29.1fbb5f5b.js"><link rel="prefetch" href="/assets/js/30.dc6a8954.js"><link rel="prefetch" href="/assets/js/31.88237e22.js"><link rel="prefetch" href="/assets/js/32.f54922c7.js"><link rel="prefetch" href="/assets/js/33.55da5043.js"><link rel="prefetch" href="/assets/js/34.dac98eb2.js"><link rel="prefetch" href="/assets/js/35.93497073.js"><link rel="prefetch" href="/assets/js/36.d4b0e799.js"><link rel="prefetch" href="/assets/js/37.5c7a76bf.js"><link rel="prefetch" href="/assets/js/38.806bd4a1.js"><link rel="prefetch" href="/assets/js/39.e42b9e34.js"><link rel="prefetch" href="/assets/js/40.bde8b4d3.js"><link rel="prefetch" href="/assets/js/41.18fa00a9.js"><link rel="prefetch" href="/assets/js/42.2c7f2862.js"><link rel="prefetch" href="/assets/js/43.48e8a33f.js"><link rel="prefetch" href="/assets/js/44.5cc2dde7.js"><link rel="prefetch" href="/assets/js/45.440e9cfa.js"><link rel="prefetch" href="/assets/js/46.b1f7b377.js"><link rel="prefetch" href="/assets/js/47.8d51c2f0.js"><link rel="prefetch" href="/assets/js/48.85d74de6.js"><link rel="prefetch" href="/assets/js/49.8859f0bb.js"><link rel="prefetch" href="/assets/js/50.b80d4c34.js"><link rel="prefetch" href="/assets/js/51.543d1120.js"><link rel="prefetch" href="/assets/js/52.0c3c3279.js"><link rel="prefetch" href="/assets/js/53.3a7deb4f.js"><link rel="prefetch" href="/assets/js/54.eaaa181f.js"><link rel="prefetch" href="/assets/js/55.25886821.js"><link rel="prefetch" href="/assets/js/56.4a0a3e24.js"><link rel="prefetch" href="/assets/js/57.8ada506b.js"><link rel="prefetch" href="/assets/js/58.b97546f4.js"><link rel="prefetch" href="/assets/js/59.83f65949.js"><link rel="prefetch" href="/assets/js/6.2b059922.js"><link rel="prefetch" href="/assets/js/7.b0f28354.js"><link rel="prefetch" href="/assets/js/8.ae241e8f.js"><link rel="prefetch" href="/assets/js/9.7f557c27.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.12cc7b8d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c63e9006.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><!----> <header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/introduction/" class="home-link"><img src="/logo.svg" alt="Documentation" class="logo"> <span class="site-name site-name--documentation can-hide">Documentation</span></a> <form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <div class="links" style="max-width:nullpx;"><a target="_blank" class="btn">Ask GPT?</a><a href="https://www.imunify360.com/support-portal/" target="_blank" class="btn">Contact Support</a><a href="https://www.imunify360.com/trial" target="_blank" class="btn">Try Free</a> <nav class="nav-links can-hide"></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><!----> <ul class="sidebar-group-items"><li><div><a href="/introduction/" class="sidebar-link link-depth-level-0">Introduction</a></div></li><li><div><a href="/billing/" class="sidebar-link link-depth-level-0">Licensing</a></div></li><li><div class="sidebar-header sidebar-link"><div><a href="/installation/" class="sidebar-link link-depth-level-0">Installation Guide</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/installation/#requirements" class="sidebar-link link-depth-level-1">Requirements</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/installation/#installation-instructions" class="sidebar-link link-depth-level-1">Installation Instructions</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/installation/#registering" class="sidebar-link link-depth-level-2">Registering</a></div></li><li class="sidebar-sub-header"><div><a href="/installation/#selinux-support" class="sidebar-link link-depth-level-2">SELinux support</a></div></li><li class="sidebar-sub-header"><div><a href="/installation/#troubleshooting" class="sidebar-link link-depth-level-2">Troubleshooting</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div><a href="/installation/#compatibility" class="sidebar-link link-depth-level-1">Compatibility</a></div></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/update/" class="sidebar-link link-depth-level-0">Update Guide</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/update/#gradual-roll-out" class="sidebar-link link-depth-level-1">Gradual roll-out</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/update/#beta" class="sidebar-link link-depth-level-1">Beta</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/update/#production" class="sidebar-link link-depth-level-1">Production</a></div></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/command_line_interface/" class="sidebar-link link-depth-level-0">Command-line Interface (CLI)</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#_3rdparty" class="sidebar-link link-depth-level-1">3rdparty</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#backup-systems" class="sidebar-link link-depth-level-1">Backup systems</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#blacklist" class="sidebar-link link-depth-level-1">Blacklist</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#blocked-ports" class="sidebar-link link-depth-level-1">Blocked ports</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#blocked-port-ip" class="sidebar-link link-depth-level-1">Blocked Port IP</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#checkdb" class="sidebar-link link-depth-level-1">Checkdb</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#check-domains" class="sidebar-link link-depth-level-1">Check-domains</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#check-modsec-directives" class="sidebar-link link-depth-level-1">Check modsec directives</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#clean" class="sidebar-link link-depth-level-1">Clean</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#config" class="sidebar-link link-depth-level-1">Config</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#doctor" class="sidebar-link link-depth-level-1">Doctor</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#eula" class="sidebar-link link-depth-level-1">Eula</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#features" class="sidebar-link link-depth-level-1">Features</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#feature-management" class="sidebar-link link-depth-level-1">Feature-management</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#fix-modsec-directives" class="sidebar-link link-depth-level-1">Fix modsec directives</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#get" class="sidebar-link link-depth-level-1">Get</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#graylist" class="sidebar-link link-depth-level-1">Graylist</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#hooks" class="sidebar-link link-depth-level-1">Hooks</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#import" class="sidebar-link link-depth-level-1">Import</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#infected-domains" class="sidebar-link link-depth-level-1">Infected-domains</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#login" class="sidebar-link link-depth-level-1">Login</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#malware" class="sidebar-link link-depth-level-1">Malware</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#notifications-config" class="sidebar-link link-depth-level-1">Notifications config</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#proactive" class="sidebar-link link-depth-level-1">Proactive</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#register" class="sidebar-link link-depth-level-1">Register</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#reload-lists" class="sidebar-link link-depth-level-1">Reload lists</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#remote-proxy" class="sidebar-link link-depth-level-1">Remote-proxy</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#rstatus" class="sidebar-link link-depth-level-1">Rstatus</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#rules" class="sidebar-link link-depth-level-1">Rules</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#submit-false-positive-false-negative" class="sidebar-link link-depth-level-1">Submit false-positive/false-negative</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#unregister" class="sidebar-link link-depth-level-1">Unregister</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#vendors" class="sidebar-link link-depth-level-1">Vendors</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#version" class="sidebar-link link-depth-level-1">Version</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#whitelist" class="sidebar-link link-depth-level-1">Whitelist</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#whitelisted-crawlers" class="sidebar-link link-depth-level-1">Whitelisted crawlers</a></div></li></ul></li><li><div class="active collapsed sidebar-header sidebar-link"><div class="active"><a href="/control_panel_integration/" class="active sidebar-link link-depth-level-0">Control panel integration</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/control_panel_integration/#introduction" class="sidebar-link link-depth-level-1">Introduction</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/control_panel_integration/#prerequisites" class="sidebar-link link-depth-level-1">Prerequisites</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/control_panel_integration/#configure-imunify360-integrations" class="sidebar-link link-depth-level-1">Configure Imunify360 integrations</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/control_panel_integration/#install-imunify360" class="sidebar-link link-depth-level-1">Install Imunify360</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/control_panel_integration/#settings-related-to-stand-alone-version" class="sidebar-link link-depth-level-1">Settings related to Stand-alone version</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/control_panel_integration/#integration-config-file" class="sidebar-link link-depth-level-1">Integration config file</a></div></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/dashboard/" class="sidebar-link link-depth-level-0">Admin Interface</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/dashboard/#support" class="sidebar-link link-depth-level-1">Support</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#dashboard" class="sidebar-link link-depth-level-1">Dashboard</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#imunify-advisor" class="sidebar-link link-depth-level-2">Imunify Advisor</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#multi-server-dashboard" class="sidebar-link link-depth-level-2">Multi-server Dashboard</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#charts-and-heat-maps" class="sidebar-link link-depth-level-2">Charts and heat maps</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div><a href="/dashboard/#incidents" class="sidebar-link link-depth-level-1">Incidents</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#firewall" class="sidebar-link link-depth-level-1">Firewall</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#ports" class="sidebar-link link-depth-level-2">Ports</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#malware-scanner" class="sidebar-link link-depth-level-1">Malware Scanner</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#users" class="sidebar-link link-depth-level-2">Users</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#malicious" class="sidebar-link link-depth-level-2">Malicious</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#scan" class="sidebar-link link-depth-level-2">Scan</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#history" class="sidebar-link link-depth-level-2">History</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#ignore-list" class="sidebar-link link-depth-level-2">Ignore List</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#proactive-defense" class="sidebar-link link-depth-level-1">Proactive Defense</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#overview" class="sidebar-link link-depth-level-2">Overview</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#user-interface" class="sidebar-link link-depth-level-2">User Interface</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div><a href="/dashboard/#reputation-management" class="sidebar-link link-depth-level-1">Reputation Management</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/dashboard/#kernelcare-integration" class="sidebar-link link-depth-level-1">KernelCare Integration</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#settings" class="sidebar-link link-depth-level-1">Settings</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#general" class="sidebar-link link-depth-level-2">General</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#malware" class="sidebar-link link-depth-level-2">Malware</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#backups" class="sidebar-link link-depth-level-2">Backups</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#disabled-rules" class="sidebar-link link-depth-level-2">Disabled Rules</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#features-management" class="sidebar-link link-depth-level-2">Features Management</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#native-feature-management" class="sidebar-link link-depth-level-2">Native Feature Management</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#whm-cpanel" class="sidebar-link link-depth-level-2">WHM/cPanel</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#attributions" class="sidebar-link link-depth-level-2">Attributions</a></div></li></ul></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/user_interface/" class="sidebar-link link-depth-level-0">User Interface</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/user_interface/#files" class="sidebar-link link-depth-level-1">Files</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/user_interface/#history" class="sidebar-link link-depth-level-1">History</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/user_interface/#ignore-list" class="sidebar-link link-depth-level-1">Ignore List</a></div></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/ids_integration/" class="sidebar-link link-depth-level-0">Other Integrations</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/ids_integration/#ids-integration" class="sidebar-link link-depth-level-1">IDS Integration</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/ids_integration/#csf-integration" class="sidebar-link link-depth-level-2">CSF Integration</a></div></li><li class="sidebar-sub-header"><div><a href="/ids_integration/#cxs-integration" class="sidebar-link link-depth-level-2">CXS Integration</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/ids_integration/#backup-providers-integration" class="sidebar-link link-depth-level-1">Backup Providers Integration</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/ids_integration/#overview" class="sidebar-link link-depth-level-2">Overview</a></div></li><li class="sidebar-sub-header"><div><a href="/ids_integration/#command-line-usage" class="sidebar-link link-depth-level-2">Command Line Usage</a></div></li><li class="sidebar-sub-header"><div><a href="/ids_integration/#using-as-library" class="sidebar-link link-depth-level-2">Using as Library</a></div></li><li class="sidebar-sub-header"><div><a href="/ids_integration/#creating-custom-backup-backend-plugin" class="sidebar-link link-depth-level-2">Creating Custom Backup Backend Plugin</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/ids_integration/#hosting-panels-firewall-rulesets-specific-settings-modsecurity" class="sidebar-link link-depth-level-1">Hosting Panels Firewall Rulesets Specific Settings &amp; ModSecurity</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/ids_integration/#cpanel" class="sidebar-link link-depth-level-2">cPanel</a></div></li><li class="sidebar-sub-header"><div><a href="/ids_integration/#plesk" class="sidebar-link link-depth-level-2">Plesk</a></div></li><li class="sidebar-sub-header"><div><a href="/ids_integration/#directadmin" class="sidebar-link link-depth-level-2">DirectAdmin</a></div></li></ul></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/features/" class="sidebar-link link-depth-level-0">Features</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/features/#external-black-whitelist-management" class="sidebar-link link-depth-level-1">External Black/Whitelist Management</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/features/#rapidscan" class="sidebar-link link-depth-level-1">RapidScan</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/features/#low-resource-usage-mode" class="sidebar-link link-depth-level-1">Low Resource Usage mode</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/features/#exim-dovecot-brute-force-attack-protection" class="sidebar-link link-depth-level-1">Exim+Dovecot brute-force attack protection</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/features/#dovecot-native-brute-force-protection" class="sidebar-link link-depth-level-2">Dovecot native brute force protection</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div><a href="/features/#notifications" class="sidebar-link link-depth-level-1">Notifications</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/features/#malware-database-scanner-mds" class="sidebar-link link-depth-level-1">Malware Database Scanner (MDS)</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/features/#how-to-use-malware-database-scanner-mds" class="sidebar-link link-depth-level-2">How to use Malware Database Scanner (MDS)</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/features/#webshield" class="sidebar-link link-depth-level-1">Webshield</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/features/#captcha" class="sidebar-link link-depth-level-2">Captcha</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#configuring-recaptcha-keys" class="sidebar-link link-depth-level-2">Configuring reCAPTCHA keys</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#cdn-support" class="sidebar-link link-depth-level-2">CDN Support</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#using-cloudflare-cache-everything-with-imunify360" class="sidebar-link link-depth-level-2">Using Cloudflare “Cache Everything” with Imunify360</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#anti-bot-protection" class="sidebar-link link-depth-level-2">Anti-bot protection</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div><a href="/features/#overridable-config" class="sidebar-link link-depth-level-1">Overridable config</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/features/#scan-of-the-system-and-user-crontab-files-for-malicious-jobs" class="sidebar-link link-depth-level-1">Scan of the system and user crontab files for malicious jobs</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/features/#hooks" class="sidebar-link link-depth-level-1">Hooks</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/features/#overview" class="sidebar-link link-depth-level-2">Overview</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#how-to-start-using-hooks" class="sidebar-link link-depth-level-2">How to start using hooks</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#available-events-and-their-parameters" class="sidebar-link link-depth-level-2">Available events and their parameters</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#cli" class="sidebar-link link-depth-level-2">CLI</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#native" class="sidebar-link link-depth-level-2">Native</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#log-file" class="sidebar-link link-depth-level-2">Log File</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#structure-and-examples-of-a-hook-script" class="sidebar-link link-depth-level-2">Structure and examples of a hook script</a></div></li></ul></li></ul></li><li><div><a href="/whmcs_plugin/" class="sidebar-link link-depth-level-0">WHMCS Plugin</a></div></li><li><div><a href="/terminology/" class="sidebar-link link-depth-level-0">Terminology</a></div></li><li><div><a href="/localization/" class="sidebar-link link-depth-level-0">Localization</a></div></li><li><div><a href="/config_file_description/" class="sidebar-link link-depth-level-0">Config File Description</a></div></li><li><div class="sidebar-header sidebar-link"><div><a href="/faq_and_known_issues/" class="sidebar-link link-depth-level-0">FAQ and Known Issues</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/faq_and_known_issues/#common-questions" class="sidebar-link link-depth-level-1">Common Questions</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_1-end-user-ip-is-blocked-and-i-do-not-know-why" class="sidebar-link link-depth-level-2">1. End user IP is blocked and I do not know why</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_2-could-i-disable-iptables-firewall-or-ossec-when-using-imunify360" class="sidebar-link link-depth-level-2">2. Could I disable IPtables (firewall) or OSSEC, when using Imunify360?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_3-does-imunify360-log-events-such-as-adding-or-removing-an-ip-to-from-the-gray-list" class="sidebar-link link-depth-level-2">3. Does Imunify360 log events such as adding or removing an IP to/from the Gray List?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_5-to-start-using-imunify360-we-need-to-know-which-information-is-sent-to-your-servers-could-you-please-give-us-some-more-information" class="sidebar-link link-depth-level-2">5. To start using Imunify360 we need to know which information is sent to your servers. Could you please give us some more information?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_6-no-valid-imunify360-license-found" class="sidebar-link link-depth-level-2">6. No valid Imunify360 License Found.</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_7-i-have-an-error-peewee-databaseerror-database-disk-image-is-malformed-what-should-i-do" class="sidebar-link link-depth-level-2">7. I have an error peewee.DatabaseError: database disk image is malformed. What should I do?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_8-why-does-my-cpanel-with-litespeed-and-owasp-modsecurity-rule-set-trigger-500-error-on-all-web-pages-after-installing-imunify360" class="sidebar-link link-depth-level-2">8. Why does my cPanel with LiteSpeed and OWASP ModSecurity rule set trigger 500 error on all web pages after installing Imunify360?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_9-disabling-waf-rules-for-certain-countries" class="sidebar-link link-depth-level-2">9. Disabling WAF rules for certain countries.</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_10-how-to-clone-imunify360-configuration-on-another-system" class="sidebar-link link-depth-level-2">10. How to clone Imunify360 configuration on another system?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_11-how-to-disable-support-icon-in-the-imunify360-ui" class="sidebar-link link-depth-level-2">11. How to disable Support icon in the Imunify360 UI?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_12-how-to-hide-the-ignore-list-tab-for-end-users-in-the-imunify360-ui" class="sidebar-link link-depth-level-2">12. How to hide the Ignore List tab for end users in the Imunify360 UI?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_13-how-to-delete-malware-scan-results-from-imunify360-s-database" class="sidebar-link link-depth-level-2">13. How to delete malware scan results from Imunify360’s database?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_14-imunify360-webshield-could-not-allocate-memory-problem-how-to-fix" class="sidebar-link link-depth-level-2">14. Imunify360 WebShield ‘Could not allocate memory’ problem. How to fix?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_15-how-to-check-modsecurity-scan-works" class="sidebar-link link-depth-level-2">15. How to check &quot;ModSecurity scan&quot; works?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_16-how-to-check-automatically-scan-all-modified-files-works" class="sidebar-link link-depth-level-2">16. How to check &quot;automatically scan all modified files&quot; works?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_17-malware-file-reasons" class="sidebar-link link-depth-level-2">17. Malware file reasons</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_18-can-imunify360-firewall-block-traffic-by-domain-name" class="sidebar-link link-depth-level-2">18. Can Imunify360 firewall block traffic by domain name?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_19-what-ports-are-used-by-webshield" class="sidebar-link link-depth-level-2">19. What ports are used by WebShield?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_20-how-to-check-that-captcha-works" class="sidebar-link link-depth-level-2">20. How to check that CAPTCHA works?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_21-how-to-edit-watched-and-excluded-patterns-for-malware-scanner" class="sidebar-link link-depth-level-2">21. How to edit watched and excluded patterns for Malware Scanner?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_22-how-to-test-rules-based-on-modsecurity-tags" class="sidebar-link link-depth-level-2">22. How to test rules based on ModSecurity tags?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_23-imunify-agent-is-not-running-troubleshooting" class="sidebar-link link-depth-level-2">23. &quot;Imunify agent is not running&quot; troubleshooting</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_24-ssh-exchange-identification-connection-closed-by-remote-host-troubleshooting" class="sidebar-link link-depth-level-2">24. &quot;sshexchangeidentification: Connection closed by remote host&quot; troubleshooting</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_25-where-can-i-find-the-files-backup-location" class="sidebar-link link-depth-level-2">25. Where can I find the files backup location?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_26-ipset-max-elements-error-hash-is-full-cannot-add-more-elements" class="sidebar-link link-depth-level-2">26. Ipset max elements error &quot;Hash is full, cannot add more elements&quot;</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_27-how-to-enable-scan-for-end-users" class="sidebar-link link-depth-level-2">27. How to enable scan for end-users?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_28-how-can-i-disable-rbl-based-waf-protection" class="sidebar-link link-depth-level-2">28. How can I disable RBL-based WAF protection?</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/faq_and_known_issues/#corner-cases" class="sidebar-link link-depth-level-1">Corner cases</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#ip-whitelisting-port-blocking-precedence" class="sidebar-link link-depth-level-2">IP whitelisting/port blocking precedence</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/faq_and_known_issues/#plesk-related" class="sidebar-link link-depth-level-1">Plesk related</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#how-to-get-an-imunify-activation-key-from-the-extended-plesk-license" class="sidebar-link link-depth-level-2">How to get an Imunify activation key from the extended Plesk license</a></div></li></ul></li></ul></li><li><div><a href="/uninstall/" class="sidebar-link link-depth-level-0">Uninstall</a></div></li></ul></div></li></ul> </div> <div class="page"> <div class="breadcrumb-wrapper page-breadcrumb" data-v-5e0e0acf><span class="breadcrumb-title" data-v-5e0e0acf>Documentation:</span> <a href="/control_panel_integration/" class="breadcrumb router-link-exact-active router-link-active" data-v-5e0e0acf>
    Control panel integration
  </a></div> <div class="page-nav-wrapper"><div class="page-nav"><a href="/command_line_interface/" class="nav-arrow left"></a> <a href="/dashboard/" class="nav-arrow right"></a></div></div> <div class="content content__default"><h1 id="control-panel-integration"><a href="#control-panel-integration" aria-hidden="true" class="header-anchor">#</a> Control panel integration</h1> <p></p><div class="table-of-contents"><ul><li><a href="#introduction">Introduction</a></li><li><a href="#prerequisites">Prerequisites</a></li><li><a href="#configure-imunify360-integrations">Configure Imunify360 integrations</a></li><li><a href="#install-imunify360">Install Imunify360</a></li><li><a href="#settings-related-to-stand-alone-version">Settings related to Stand-alone version</a></li><li><a href="#integration-config-file">Integration config file</a></li></ul></div><p></p> <h2 id="introduction"><a href="#introduction" aria-hidden="true" class="header-anchor">#</a> Introduction</h2> <p>Imunify360 can be installed directly on the server, independent of any panel, regardless of the administrative interface.</p> <p>It is also called stand-alone, non-panel, generic panel integration).</p> <h4 id="limitations"><a href="#limitations" aria-hidden="true" class="header-anchor">#</a> Limitations</h4> <ul><li>No support for managing disabled rules yet. See also: <a href="/dashboard/#disabled-rules">Disabled rules</a></li></ul> <h4 id="requirements"><a href="#requirements" aria-hidden="true" class="header-anchor">#</a> Requirements</h4> <p><strong>Operating system</strong></p> <ul><li>CentOS 6/7/8</li> <li>RHEL 6/7</li> <li>CloudLinux OS</li> <li>Ubuntu 16.04/18.04/20.04/22</li> <li>Debian 9/10</li> <li>Rocky Linux 8</li></ul> <p><strong>Web servers</strong></p> <ul><li>Apache &gt;= 2.4.30</li> <li>LiteSpeed</li> <li>Nginx</li></ul> <h4 id="there-are-four-main-steps-in-general-required-for-having-imunify360-stand-alone-running-on-your-server"><a href="#there-are-four-main-steps-in-general-required-for-having-imunify360-stand-alone-running-on-your-server" aria-hidden="true" class="header-anchor">#</a> There are four main steps in general required for having Imunify360 Stand-alone running on your server:</h4> <ol><li>Install and configure the prerequisites like web servers modules or so</li> <li>Configure Imunify360 integrations like authentication or <span class="notranslate"><code>mod_security</code></span> configuration</li> <li>Install Imunify360</li> <li>Change default Imunify360 settings to reflect your needs</li></ol> <div class="warning custom-block"><p class="custom-block-title">Warning</p><p>Imunify Web-UI PHP code has to be executed under a non-root user which has access to <code>/var/run/defence360agent/non_root_simple_rpc.sock</code>. If it runs in CageFS, you'll need to configure it accordingly.</p></div><p>To allow non-root user in CageFS access to the socket, this workaround should be applied:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment"># create directory for moun-point</span>
<span class="token function">mkdir</span> /imunify-ui-shared
<span class="token comment"># add symlink for user which belong to UI backend `imunify-web` in this example)</span>
<span class="token function">ln</span> -s /var/run/defence360agent /imunify-ui-shared/imunify-web
<span class="token comment"># add symlink to cagefs skeleton</span>
<span class="token function">rm</span> -f /usr/share/cagefs-skeleton/var/run/defence360agent
<span class="token function">ln</span> -s /imunify-ui-shared/imunify-web /usr/share/cagefs-skeleton/var/run/defence360agent
<span class="token comment"># add mount point to cagefs</span>
<span class="token keyword">echo</span> <span class="token string">&quot;%/imunify-ui-shared&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/cagefs/cagefs.mp
<span class="token comment"># remount all</span>
cagefsctl --remount-all
</code></pre></div><h2 id="prerequisites"><a href="#prerequisites" aria-hidden="true" class="header-anchor">#</a> Prerequisites</h2> <p>Imunify360 Stand-alone version requires the following components installed or enabled at the server:</p> <ul><li>ModSecurity 2.9.x for Apache or ModSecurity 3.0.x for Nginx</li> <li>Apache module <span class="notranslate"><code>mod_remoteip</code></span> or nginx module <span class="notranslate"><code>ngx_http_realip_module</code></span></li> <li>PHP with <span class="notranslate"><code>json</code></span> extension loaded and <span class="notranslate"><code>proc_open</code></span> function enabled (remove it from the <span class="notranslate"><code>disable_functions</code></span> list in <span class="notranslate"><code>php.ini</code></span>)</li></ul> <div class="warning custom-block"><p class="custom-block-title">Warning</p><p>We recommend using the stable versions of ModSecurity3 (i.e. 3.0.4), because developing versions (i.e. master) can have
stability issues (see <a href="https://github.com/SpiderLabs/ModSecurity/issues/2381" target="_blank" rel="noopener noreferrer">https://github.com/SpiderLabs/ModSecurity/issues/2381<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for example).</p></div><h2 id="configure-imunify360-integrations"><a href="#configure-imunify360-integrations" aria-hidden="true" class="header-anchor">#</a> Configure Imunify360 integrations</h2> <p>Imunify360 Stand-alone version require the following integrations before installation:</p> <ul><li>Integration with web server for serving UI</li> <li>Interaction with ModSecurity</li> <li>Integration with WebShield</li> <li>Integration with Malware Scanner</li> <li>Integration with authentication service</li> <li>Define administrators for Imunify360</li></ul> <p>All integrations set in the integration config file like <span class="notranslate"><code>/etc/sysconfig/imunify360/integration.conf</code></span>. You can find more details on config file <a href="/installation/#integration-config-file">here</a>.</p> <h4 id="integration-with-web-server"><a href="#integration-with-web-server" aria-hidden="true" class="header-anchor">#</a> Integration with web server</h4> <p>Imunify360 UI is implemented as a single-page application (SPA) and requires a web server to serve it.
It’s required to specify a path to the web server directory, where the Imunify360 UI SPA application will be installed and served.</p> <p>Example</p> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[paths]</span>
<span class="token constant">ui_path</span> <span class="token attr-value"><span class="token punctuation">=</span> /var/www/vhosts/imunify360/imunify360.hosting.example.com/html/im360</span>
</code></pre></div></div> <p>Ensure that the domain you are going to use for the Imunify360 web-based UI refers to this path and that there are no other scripts or files under <span class="notranslate"><code>ui_path</code></span>, as they might be overridden by Imunify360 installation.</p> <h4 id="apache-and-litespeed"><a href="#apache-and-litespeed" aria-hidden="true" class="header-anchor">#</a> Apache and LiteSpeed</h4> <p>Configure <a href="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-%28v2.x%29#Configuration_Directives" target="_blank" rel="noopener noreferrer">ModSecurity configuration directives<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (so that it can block):</p> <div class="notranslate"><div class="language-apacheconf extra-class"><pre class="language-apacheconf"><code>SecAuditEngine RelevantOnly
SecConnEngine Off
SecRuleEngine On
</code></pre></div></div> <p>Create the empty file <span class="notranslate"><code>/etc/sysconfig/imunify360/generic/modsec.conf</code></span> and include it into the web server config as <span class="notranslate"><code>IncludeOptional</code></span>. The file would be replaced with the actual config during the first Imunify360 installation or you can fill it via calling the Imunify360 ModSec ruleset installation <span class="notranslate"><code>imunify360-agent install-vendors</code></span>.</p> <h4 id="nginx"><a href="#nginx" aria-hidden="true" class="header-anchor">#</a> Nginx</h4> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>ModSecurity has different syntax comparing to Nginx configuration, thus ModSecurity directives can not be directly included to the Nginx config files.</p></div><p>Create a separate file (i.e. <span class="notranslate"><code>/etc/nginx/modsec.conf</code></span>) and set the following ModSecurity directives in it:</p> <div class="notranslate"><div class="language-apacheconf extra-class"><pre class="language-apacheconf"><code>SecAuditEngine RelevantOnly
SecConnEngine Off
SecRuleEngine On
SecAuditLogFormat JSON
<span class="token comment"># should match modsec_audit_log option in integration.conf (see below)</span>
SecAuditLog /var/log/nginx/modsec_audit_log
</code></pre></div></div> <div class="danger custom-block"><p class="custom-block-title">Warning</p><p>ModSecurity on Nginx does not properly re-opens audit log on SIGHUP/SIGUSR1, which can cause logrotate to break integration with Imunify360. See <a href="https://github.com/SpiderLabs/ModSecurity-nginx/issues/121" target="_blank" rel="noopener noreferrer">https://github.com/SpiderLabs/ModSecurity-nginx/issues/121<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for details.</p></div><p>Create an empty file <span class="notranslate"><code>/etc/sysconfig/imunify360/generic/modsec.conf</code></span>. The file would be replaced with the actual config during the first Imunify360 installation or you can fill it via calling the Imunify360 ModSec ruleset installation <span class="notranslate"><code>imunify360-agent install-vendors</code></span>.</p> <p>Then enable ModSecurity and include both files into Nginx configuration using the <span class="notranslate"><code>modsecurity_rules_file</code></span> directive:</p> <div class="language- extra-class"><pre class="language-text"><code>modsecurity on;
modsecurity_rules_file /etc/nginx/modsec.conf;
modsecurity_rules_file /etc/sysconfig/imunify360/generic/modsec.conf;
</code></pre></div><h4 id="imunify360-integration-configuration"><a href="#imunify360-integration-configuration" aria-hidden="true" class="header-anchor">#</a> Imunify360 integration configuration</h4> <p>Set the path and graceful restart script in the <span class="notranslate"><code>integration.conf</code></span></p> <ul><li><span class="notranslate"><code>[web_server].graceful_restart_script</code></span> – a script that restarts the web server to be called after any changes in web server config or ModSecurity rules</li> <li><span class="notranslate"><code>[web_server].modsec_audit_log</code></span> – a path to ModSecurity audit log file</li> <li><span class="notranslate"><code>[web_server].modsec_audit_logdir</code></span> – a path to ModSecurity audit log directory (required when the <span class="notranslate"><code>SecAuditLogType</code></span> set to the <span class="notranslate"><code>Concurrent</code></span>)</li></ul> <p>Example</p> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[web_server]</span>
<span class="token constant">server_type</span> <span class="token attr-value"><span class="token punctuation">=</span> apache</span>
<span class="token constant">graceful_restart_script</span> <span class="token attr-value"><span class="token punctuation">=</span> /usr/sbin/apachectl restart</span>
<span class="token constant">modsec_audit_log</span> <span class="token attr-value"><span class="token punctuation">=</span> /var/log/httpd/modsec_audit.log</span>
<span class="token constant">modsec_audit_logdir</span> <span class="token attr-value"><span class="token punctuation">=</span> /var/log/modsec_audit</span>
</code></pre></div></div> <p>To enable domain-specific ModSecurity configuration, specify the <span class="notranslate"><code>modsec_domain_config_script</code></span> in the <span class="notranslate"><code>integration.conf</code></span>.</p> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[integration_scripts]</span>
<span class="token constant">modsec_domain_config_script</span> <span class="token attr-value"><span class="token punctuation">=</span> /path/to/inject/domain/specific/config/script.sh</span>
</code></pre></div></div> <p>It should point to an executable file that accepts as an input a list of domain-specific web server settings and injects them into the server config. The standard input (stdin) is given in the <a href="http://jsonlines.org/" target="_blank" rel="noopener noreferrer">JSON Lines<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> format similar to the following:</p> <div class="notranslate"><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;user&quot;</span><span class="token operator">:</span> <span class="token string">&quot;username&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;domain&quot;</span><span class="token operator">:</span> <span class="token string">&quot;example.com&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;content&quot;</span><span class="token operator">:</span> <span class="token string">&quot;modsec config text&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;user&quot;</span><span class="token operator">:</span> <span class="token string">&quot;another&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;domain&quot;</span><span class="token operator">:</span> <span class="token string">&quot;another.example.com&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;content&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">}</span>
</code></pre></div></div> <p>Each line contains config for a single domain e.g., it may contain rule tags excluded for the domain.
The script should also restart the web server to apply the configuration. This should be done so that the script could implement the check that web server comes up after config change, and reset configuration if it doesn't.</p> <p>If configuration change failed, the script should return 1, and in the standard error stream (stderr) it should return the reason for failure. On success, the script should return 0.
In a single run of the script, we might update a single domain/user, as well as multiple users (all users) on the system.</p> <h4 id="integration-with-webshield"><a href="#integration-with-webshield" aria-hidden="true" class="header-anchor">#</a> Integration with WebShield</h4> <p>WebShield consists of four services:</p> <ul><li>WebShield itself</li> <li>Shared memory daemon makes it easier to deal with certain aspects of Nginx configuration without reloading</li> <li>SSL-caching daemon watches changes to host SSL certificate sets (for known hosting panels only: cPanel, Plesk, DirectAdmin) and updates the WebShield SSL cache when a certificate is added, updated or removed</li> <li>Sentrylogs daemon watches WebShield log files to detect errors</li></ul> <p>The configuration of WebShield is done by an agent, and direct editing of WebShield configuration files is generally not recommended. This is mainly because after the next reconfiguration all custom changes would be lost. However, a host administrator is allowed to set a certificate as the default one for WebShield to return.</p> <h4 id="how-to-enable-webshield-in-the-imunify360-config-file-and-start-the-service"><a href="#how-to-enable-webshield-in-the-imunify360-config-file-and-start-the-service" aria-hidden="true" class="header-anchor">#</a> How to enable WebShield in the Imunify360 config file and start the service</h4> <p>When Imunify360 stand-alone is installed, WebShield is disabled by default.</p> <p>You can enable it only via CLI. To do so, run the following commands:</p> <ol><li><div class="language- extra-class"><pre class="language-text"><code> imunify360-agent config update '{&quot;WEBSHIELD&quot;: {&quot;enable&quot;: true, &quot;known_proxies_support&quot;: true}}'
</code></pre></div></li> <li><div class="language- extra-class"><pre class="language-text"><code> systemctl enable imunify360-webshield
</code></pre></div></li> <li><div class="language- extra-class"><pre class="language-text"><code> systemctl restart imunify360-webshield
</code></pre></div></li></ol> <h4 id="set-default-ssl-certificate-explicitly"><a href="#set-default-ssl-certificate-explicitly" aria-hidden="true" class="header-anchor">#</a> Set default SSL certificate explicitly</h4> <ol><li>Place a certificate and a key into the <span class="notranslate"><code>/etc/imunify360-webshield/ssl_certs</code></span> folder</li> <li>If required, in the <span class="notranslate"><code>/etc/imunify360-webshield/ssl.conf</code></span> file, change the following directives according to your changes:</li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>ssl_certificate             ssl_certs/dummy.pem;

ssl_certificate_key         ssl_certs/dummy.pem;
</code></pre></div></div> <p>If you want to provide intermediate certificates, they are to be appended to the certificate file.</p> <p>These settings require WebShield to be restarted/reloaded.</p> <h4 id="manage-webshield-ssl-cache-manually"><a href="#manage-webshield-ssl-cache-manually" aria-hidden="true" class="header-anchor">#</a> Manage WebShield SSL cache manually</h4> <p>To manually manage the certificate cache, use the <span class="notranslate"><code>/usr/sbin/im360-ssl-cache</code></span> utility.</p> <p>To add certificates to the cache, a user would run the command:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>im360-ssl-cache --add /path/to/certs.json
</code></pre></div></div> <p>The <span class="notranslate"><code>--add</code></span> parameter accepts exactly one value. If the parameter value is not <code>-</code>, it is taken as a path to a file in JSON format with a list of certificates and private keys to be added. Otherwise, if the parameter value is <code>-</code>, data is expected to be sent in JSON format to STDIN as in the following example:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>cat certs.json | im360-ssl-cache --add -
</code></pre></div></div> <p>Format of JSON file:</p> <div class="notranslate"><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
      <span class="token property">&quot;domain&quot;</span><span class="token operator">:</span> <span class="token string">&quot;john.example.com&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;-----BEGIN PRIVATE KEY-----\nM...O\n-----END PRIVATE KEY-----\n&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;certificate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;-----BEGIN CERTIFICATE-----\nMI...Y=\n-----END CERTIFICATE-----\n&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;chain&quot;</span><span class="token operator">:</span> <span class="token string">&quot;-----BEGIN CERTIFICATE-----\nM...I=\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nM...U=\n-----END CERTIFICATE-----\n&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;domain&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bob.example.com&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;certificate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;chain&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div></div> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>As JSON text is not allowed to have line breaks, all newline symbols must be escaped as in the example above.</p></div><p>To remove certificate(s) from the cache, a user is expected to run the command:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>im360-ssl-cache --remove example.org example.com …
</code></pre></div></div> <p>The <span class="notranslate"><code>--remove</code></span> parameter expects one or more space-separated domain names, for which certificates are to be removed from the cache.</p> <p>When no parameters are passed, the <span class="notranslate"><code>im360-ssl-cache</code></span> simply lists all domain names of certificates in the cache.</p> <div class="warning custom-block"><p class="custom-block-title">Note</p><p>Passing certificates data in JSON format is done to put data flow in good order, to avoid excessive checks of data. No certificate checks are made.</p></div><h4 id="non-sni-requests"><a href="#non-sni-requests" aria-hidden="true" class="header-anchor">#</a> Non-SNI requests</h4> <p>When a request without Server Name Indication (SNI) comes, WebShield has to guess what certificate from the cache to serve.</p> <p>To allow WebShield to handle non-SNI requests properly, include an <code>ip</code> field in the JSON that you pass to the <span class="notranslate"><code>im360-ssl-cache</code></span>.</p> <div class="notranslate"><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token property">&quot;domain&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;certificate&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;chain&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;ip&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span>  // NEW<span class="token punctuation">,</span> optional<span class="token punctuation">,</span> NOT UNIQUE
    <span class="token punctuation">}</span><span class="token punctuation">,</span>..
<span class="token punctuation">]</span>
</code></pre></div></div> <p>WebShield will use this data to decide which certificate to serve if a request without Server Name Indication (SNI) arrives. If there are several domains with the specified IPs, WebShield will use the first one alphabetically.</p> <h4 id="required-web-server-configuration-to-correctly-detect-client-ip-addresses-from-headers"><a href="#required-web-server-configuration-to-correctly-detect-client-ip-addresses-from-headers" aria-hidden="true" class="header-anchor">#</a> Required web server configuration to correctly detect client IP addresses from headers</h4> <p>To ensure WebShield and Graylist are working correctly (e.g. a correct IP is passed to ModSecurity), the server must recognize WebShield as an internal proxy. For example, for Apache, <code>mod_remoteip</code> must be installed and configured like this:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>&lt;IfModule remoteip_module&gt;
    RemoteIPInternalProxy 127.0.0.1
    RemoteIPInternalProxy ::1
    RemoteIPHeader X-Forwarded-For
&lt;/IfModule&gt;
</code></pre></div></div> <p>For Nginx, the <span class="notranslate"><code>ngx_http_realip_module</code></span> module should be configured in the following way:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>real_ip_header X-Forwarded-For;
set_real_ip_from 127.0.0.1;
set_real_ip_from ::1;
</code></pre></div></div> <p>WebShield passes the real client IP in the <span class="notranslate"><code>X-Forwarded-For</code></span> header.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>In the Apache LogFormat configuration strings for correct representation of a remote host IP address it is required using:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>%a	Client IP address of the request
</code></pre></div></div> <p>instead of</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>%h	Remote hostname
</code></pre></div></div> <p>You can find more details at <a href="http://httpd.apache.org/docs/current/mod/mod_log_config.html" target="_blank" rel="noopener noreferrer">http://httpd.apache.org/docs/current/mod/mod_log_config.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></div><h4 id="integration-with-malware-scanner"><a href="#integration-with-malware-scanner" aria-hidden="true" class="header-anchor">#</a> Integration with Malware Scanner</h4> <p>To scan files uploaded via FTP, configure <a href="https://www.pureftpd.org/project/pure-ftpd/" target="_blank" rel="noopener noreferrer">PureFTPd<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Write in the <span class="notranslate"><code>pure-ftp.conf</code></span>:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>CallUploadScript             yes
</code></pre></div></div> <p>To scan files for changes (to detect malware) using inotify, configure which directories to watch and which to ignore in the <span class="notranslate"><code>integration.conf</code></span> file:</p> <ul><li>configure <span class="notranslate"><code>[malware].basedir</code></span> – a root directory to watch (recursively)</li> <li>configure <span class="notranslate"><code>[malware].pattern_to_watch</code></span> – only directories that match this (<a href="https://docs.python.org/3/howto/regex.html#regex-howto" target="_blank" rel="noopener noreferrer">Python<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>) regex in the basedir are actually going to be watched</li></ul> <p>Example</p> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[malware]</span>
<span class="token constant">basedir</span> <span class="token attr-value"><span class="token punctuation">=</span> /home</span>
<span class="token constant">pattern_to_watch</span> <span class="token attr-value"><span class="token punctuation">=</span> ^/home/.+?/(public_html|public_ftp|private_html)(/.*)?$</span>
</code></pre></div></div> <h4 id="integration-with-authentication-service"><a href="#integration-with-authentication-service" aria-hidden="true" class="header-anchor">#</a> Integration with authentication service</h4> <p>Imunify360 Stand-alone version can use PAM service to authenticate users for the Imunify360 UI application.</p> <p>You can specify which PAM service Imunify360 should use with the <span class="notranslate"><code>service_name</code></span> option:</p> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[pam]</span>
<span class="token constant">service_name</span> <span class="token attr-value"><span class="token punctuation">=</span> system-auth</span>
</code></pre></div></div> <p>You can get a token which can be used for authentication using the <a href="/command_line_interface/#login"><span class="notranslate"><code>login</code></span> command</a>.</p> <h4 id="define-administrators-for-imunify360"><a href="#define-administrators-for-imunify360" aria-hidden="true" class="header-anchor">#</a> Define administrators for Imunify360</h4> <p>The administrators have full access to Imunify360 UI and its settings.</p> <p>By default, <span class="notranslate"><code>root</code></span> is considered to be the only <span class="notranslate"><code>admin</code></span> user.</p> <p>To add more administrators, list them in the <span class="notranslate"><code>/etc/sysconfig/imunify360/auth.admin</code></span> file
or specify the admins option in the <span class="notranslate"><code>/etc/sysconfig/imunify360/integration.conf</code></span></p> <p>Admin users will be merged from three sources: <span class="notranslate"><code>/etc/sysconfig/imunify360/auth.admin</code></span> list and scripts defined in the
<span class="notranslate"><code>/etc/sysconfig/imunify360/integration.conf</code></span> or <span class="notranslate"><code>/opt/cpvendor/etc/integration.ini</code></span> that return user lists.</p> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[integration_scripts]</span>
<span class="token constant">admins</span> <span class="token attr-value"><span class="token punctuation">=</span> /path/to/get-admins-script.sh</span>
</code></pre></div></div> <p>It should point to an executable file that generates a JSON file similar to the following:</p> <div class="notranslate"><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin1&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;unix_user&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;locale_code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;EN_us&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin1@domain.zone&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;is_main&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span>
      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin2&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;unix_user&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;locale_code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Ru_ru&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin2@domain.zone&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;is_main&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ok&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h2 id="install-imunify360"><a href="#install-imunify360" aria-hidden="true" class="header-anchor">#</a> Install Imunify360</h2> <p>The installation instructions are the same as for cPanel/Plesk/DirectAdmin version and can be found in the <a href="/installation/#installation-instructions">Imunify360 documentation</a>.</p> <h2 id="settings-related-to-stand-alone-version"><a href="#settings-related-to-stand-alone-version" aria-hidden="true" class="header-anchor">#</a> Settings related to Stand-alone version</h2> <p>The web-based UI is available via the domain configured in the <span class="notranslate"><code>ui_path</code></span>.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>No files should be located in the folder configured with <span class="notranslate"><code>ui_path</code></span>. We do not recommend using a directory in which any files are stored as a directory for Imunify UI files.</p></div><p>For example, if <span class="notranslate"><code>/var/www/vhosts/imunify360/imunify360.hosting.example.com/html/im360</code></span> is the document root folder for the <span class="notranslate"><code>imunify360.hosting.example.com</code></span> domain, then you could open Imunify360 with the following URL:</p> <ul><li><span class="notranslate"><code>https://imunify360.hosting.example.com/</code></span> (when you have TLS certificate configured for the domain) or</li> <li><span class="notranslate"><code>http://imunify360.hosting.example.com/</code></span></li></ul> <h4 id="use-a-specific-list-of-users-in-imunify360"><a href="#use-a-specific-list-of-users-in-imunify360" aria-hidden="true" class="header-anchor">#</a> Use a specific list of users in Imunify360</h4> <p>By default, Imunify360 will use Linux system users, limited by <span class="notranslate"><code>uid_min</code></span> and <span class="notranslate"><code>uid_max</code></span> from the <span class="notranslate"><code>/etc/login.defs</code></span>.</p> <p>If you want to see a specific list of users (note, that all of them must be real Linux users accessible via PAM), you can specify the <span class="notranslate"><code>users</code></span> option in the <span class="notranslate"><code>/etc/sysconfig/imunify360/integration.conf</code></span>:</p> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[integration_scripts]</span>
<span class="token constant">users</span> <span class="token attr-value"><span class="token punctuation">=</span> /path/to/get-users-script.sh</span>
</code></pre></div></div> <p>It should point to an executable file that generates a JSON file similar to the following (see details <a href="/stand_alone/#integration-config-file">here</a>):</p> <div class="notranslate"><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
      <span class="token property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ins5yo3&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;owner&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;domain&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ins5yo3.com&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;package&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;package&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;owner&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ins5yo3@ins5yo3.com&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;locale_code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;EN_us&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1001</span><span class="token punctuation">,</span>
      <span class="token property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ins5yo4&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;owner&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;domain&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ins5yo4.com&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;package&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;package&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;owner&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ins5yo4@ins5yo4.com&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;locale_code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;EN_us&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ok&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h4 id="use-server-domains"><a href="#use-server-domains" aria-hidden="true" class="header-anchor">#</a> Use server domains</h4> <p>To provide a list of domains for Imunify360, specify the script that generates a JSON file in the <span class="notranslate"><code>/etc/sysconfig/imunify360/integration.conf</code></span>:</p> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[integration_scripts]</span>
<span class="token constant">domains</span> <span class="token attr-value"><span class="token punctuation">=</span> /path/to/get-domains-script.sh</span>
</code></pre></div></div> <p>A JSON file should be similar to the following:</p> <div class="notranslate"><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;example.com&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;document_root&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/home/username/public_html/&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;is_main&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token property">&quot;owner&quot;</span><span class="token operator">:</span> <span class="token string">&quot;username&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;subdomain.example.com&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;document_root&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/home/username/public_html/subdomain/&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;is_main&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token property">&quot;owner&quot;</span><span class="token operator">:</span> <span class="token string">&quot;username&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ok&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <p><span class="notranslate"><code>web_server_config_path</code></span> should point to a path that is added as <span class="notranslate"><code>IncludeOptional</code></span> in this domain's virtual host e.g., <span class="notranslate"><code>/path/to/example.com/specific/config/to/include</code></span> path should be added for the <span class="notranslate"><code>example.com</code></span> domain.</p> <h2 id="integration-config-file"><a href="#integration-config-file" aria-hidden="true" class="header-anchor">#</a> Integration config file</h2> <p>The documentation for the Imunify360 Stand-alone version integration configuration file format.</p> <p><strong>Location</strong> <span class="notranslate"><code>/etc/sysconfig/imunify360/integration.conf</code></span></p> <p><strong>Parameters</strong></p> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[paths]</span>
<span class="token constant">ui_path</span> <span class="token attr-value"><span class="token punctuation">=</span> /var/www/vhosts/imunify360/imunify360.hosting.example.com/html/im360</span>
</code></pre></div></div> <p>The path to the web server directory, where Imunify360 will be installed and served by web server. Need to be defined before Imunify360 installation.</p> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[paths]</span>
<span class="token constant">ui_path_owner</span> <span class="token attr-value"><span class="token punctuation">=</span> panel_user:web_server_group</span>
</code></pre></div></div> <p>Allows executing <code>chown</code> to that owner for files after installation. The parameter is optional, if it is absent, <code>chown</code> doesn't execute.</p> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[pam]</span>
<span class="token constant">service_name</span> <span class="token attr-value"><span class="token punctuation">=</span> system-auth</span>
</code></pre></div></div> <p>The PAM service is used for user authentication in the Imunify360 UI application.
By default the <span class="notranslate"><code>system-auth</code></span> service is used.</p> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[integration_scripts]</span>
<span class="token constant">admins</span> <span class="token attr-value"><span class="token punctuation">=</span> /path/to/get-admins-script.sh</span>
</code></pre></div></div> <p>The path to the executable script that generates a JSON file with the list of admin accounts.</p> <div class="notranslate"><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin1&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;unix_user&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;locale_code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;EN_us&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin1@domain.zone&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;is_main&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span>
      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin2&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;unix_user&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;locale_code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Ru_ru&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin2@domain.zone&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;is_main&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ok&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[integration_scripts]</span>
<span class="token constant">users</span> <span class="token attr-value"><span class="token punctuation">=</span> /path/to/get-users-script.sh</span>
</code></pre></div></div> <p>The script to provide the specific list of users used by Imunify360.</p> <p>It should point to an executable file that generates a JSON file similar to the following (domains are optional):</p> <div class="notranslate"><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
      <span class="token property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ins5yo3&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;owner&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;domain&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ins5yo3.com&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;package&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;package&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;owner&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ins5yo3@ins5yo3.com&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;locale_code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;EN_us&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1001</span><span class="token punctuation">,</span>
      <span class="token property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ins5yo4&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;owner&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;domain&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ins5yo4.com&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;package&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;package&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;owner&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root&quot;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ins5yo4@ins5yo4.com&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;locale_code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;EN_us&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ok&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <h4 id="data-description"><a href="#data-description" aria-hidden="true" class="header-anchor">#</a> Data description</h4> <table><thead><tr><th></th> <th></th> <th></th></tr></thead> <tbody><tr><td>Key</td> <td>Nullable</td> <td>Description</td></tr> <tr><td><span class="notranslate"><code>id</code></span></td> <td><span class="notranslate"><code>False</code></span></td> <td>ID of the UNIX account in the system.</td></tr> <tr><td><span class="notranslate"><code>username</code></span></td> <td><span class="notranslate"><code>False</code></span></td> <td>The name of the UNIX account in the system.</td></tr> <tr><td><span class="notranslate"><code>owner</code></span></td> <td><span class="notranslate"><code>True</code></span></td> <td>The name of the account owner. The owner can be an administrator (in this case he should be included in the <span class="notranslate"><code>admins()</code></span> output) or a reseller (in this case he should be included in the <span class="notranslate"><code>resellers()</code></span> output).</td></tr> <tr><td><span class="notranslate"><code>locale_code</code></span></td> <td><span class="notranslate"><code>True</code></span></td> <td>The locale selected by a user.</td></tr> <tr><td><span class="notranslate"><code>email</code></span></td> <td><span class="notranslate"><code>True</code></span></td> <td>Email of the account user. If there is no email, it should return null.</td></tr> <tr><td><span class="notranslate"><code>domain</code></span></td> <td><span class="notranslate"><code>True</code></span></td> <td>The main domain of a user.</td></tr> <tr><td><span class="notranslate"><code>package</code></span></td> <td><span class="notranslate"><code>True</code></span></td> <td>Information about the package to which a user belongs to. If the user doesn’t belong to any package, it should return null.</td></tr> <tr><td><span class="notranslate"><code>package.name</code></span></td> <td><span class="notranslate"><code>False</code></span></td> <td>The name of the package to which a user belongs to.</td></tr> <tr><td><span class="notranslate"><code>package.owner</code></span></td> <td><span class="notranslate"><code>True</code></span></td> <td>The owner of the package to which a user belongs to (reseller or administrator).</td></tr></tbody></table> <div class="notranslate"><div class="language-ini extra-class"><pre class="language-ini"><code><span class="token selector">[integration_sctipts]</span>
<span class="token constant">domains</span> <span class="token attr-value"><span class="token punctuation">=</span> /path/to/get-domains-script.sh</span>
</code></pre></div></div> <p>It should point to an executable file that generates a JSON file similar to the following</p> <div class="notranslate"><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;example.com&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;document_root&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/home/username/public_html/&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;is_main&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token property">&quot;owner&quot;</span><span class="token operator">:</span> <span class="token string">&quot;username&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;subdomain.example.com&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;document_root&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/home/username/public_html/subdomain/&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;is_main&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token property">&quot;owner&quot;</span><span class="token operator">:</span> <span class="token string">&quot;username&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;metadata&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;result&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ok&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <p><span class="notranslate"><code>web_server_config_path</code></span> should point to a path that is added as <span class="notranslate"><code>IncludeOptional</code></span> in this domain's virtual host e.g., <span class="notranslate"><code>/path/to/example.com/specific/config/to/include</code></span> path should be added for the <span class="notranslate"><code>example.com</code></span> domain.</p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/cloudlinux/imunify360-doc/edit/dev/docs/control_panel_integration/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="back-to-top" data-v-c64d4a1e><a class="nav-arrow top back-to-top__link" data-v-c64d4a1e></a></div> </div> <div class="footer" data-v-671babf6><div data-v-671babf6><a href="https://cloudlinux.com" data-v-671babf6><img src="/assets/img/we-are-cloudlinux.783ed390.svg" alt="We are Cloudlinux" data-v-671babf6></a></div> <div class="footer-company-title" data-v-671babf6>2023. CloudLinux Inc</div> <div data-v-671babf6><div data-v-671babf6><a href="https://cloudlinux.zendesk.com/hc/en-us/categories/360002375980-Imunify-Security-Products" target="_blank" data-v-671babf6>How to</a></div><div data-v-671babf6><a href="https://www.imunify360.com/getting-started" target="_blank" data-v-671babf6>Getting started</a></div><div data-v-671babf6><a href="https://cloudlinux.zendesk.com/hc/en-us/requests/new" target="_blank" data-v-671babf6>Submit request</a></div><div data-v-671babf6><a href="https://blog.imunify360.com" target="_blank" data-v-671babf6>Blog</a></div></div> <div class="social" data-v-671babf6><span class="footer-social-text" data-v-671babf6>Stay in touch</span> <a href="https://www.facebook.com/imunify360/" target="_blank" data-v-671babf6><img src="/fb.png" class="footer-social-logo" data-v-671babf6></a><a href="https://twitter.com/imunify360/" target="_blank" data-v-671babf6><img src="/tw.png" class="footer-social-logo" data-v-671babf6></a><a href="https://linkedin.com/company/cloudlinux" target="_blank" data-v-671babf6><img src="/in.png" class="footer-social-logo" data-v-671babf6></a><a href="https://www.youtube.com/channel/UCcW6dDJjcy41c7Hl_5LdLZQ" target="_blank" data-v-671babf6><img src="/ytube.png" class="footer-social-logo" data-v-671babf6></a></div></div> <!----></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.e0653151.js" defer></script><script src="/assets/js/5.92c348f6.js" defer></script><script src="/assets/js/1.443374ed.js" defer></script><script src="/assets/js/28.39653462.js" defer></script><script src="/assets/js/2.8a6413a2.js" defer></script>
  </body>
</html>
